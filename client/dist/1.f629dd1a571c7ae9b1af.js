(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{101:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l}));var o=n(98);const a=Object(o.a)();let c=async()=>await fetch(`${a}/technologies`).then(e=>e.json()).then(e=>e),i=async e=>await fetch(`${a}/technologies`,{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>e);const s=async(e,t)=>{await fetch(`${a}/technologies/${t}`,{method:"put",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>e)},l=async e=>{await fetch(`${a}/technologies/${e}`,{method:"delete",headers:{"Content-Type":"application/json"}}).then(e=>e).then(e=>e)}},102:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l}));var o=n(98);const a=Object(o.a)();let c=async()=>await fetch(`${a}/projects`).then(e=>e.json()).then(e=>e);const i=async e=>{const t=await fetch(`${a}/projects`,{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>e);console.log(t)},s=async(e,t)=>{await fetch(`${a}/projects/${t}`,{method:"put",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>e)},l=async e=>{const t=await fetch(`${a}/projects/${e}`,{method:"delete",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>e);console.log(t)}},105:function(e,t,n){"use strict";n.r(t),n.d(t,"Projects",(function(){return h}));var o=n(0),a=n(99),c=n(100),i=n(4),s=n(102),l=n(3),d=n(108);n(109);const r=e=>{for(;e.childNodes.length;)e.removeChild(e.lastChild)};async function h(){const e=Object(o.e)(".scrollable-content");r(e),e.appendChild(Object(o.c)("div","loading")).innerHTML="loading...";const t=await Object(a.d)(),n=await Object(s.c)();r(e);const p=e.clientWidth;if(n.forEach(async(n,a)=>{const i=e.appendChild(Object(o.c)("div","project-wrap")),r=i.appendChild(Object(c.a)(`src/img/${n.img_url}`,n.name,!0,n.site_url,n.build_date));let u="false",f=Object(o.c)("div","link-modal"),j=Object(o.f)(".img-wrapper"),b=Object(o.f)(".inner-img-wrap"),g=Object(o.c)("div","tech-icons");n.technologies.forEach(e=>{g.appendChild(Object(o.c)("img","tech-icon")).src=`src/img/${e.icon_url}`});let m=Object(o.c)("div","description");if(m.innerHTML=n.description,p<900?(f.appendChild(g),f.appendChild(m)):(f.appendChild(m),f.appendChild(g)),f.appendChild(Object(o.c)("div","link-modal-icons")).innerHTML=`<div><a href=${n.site_url} target='_blank'><i class="fas fa-home fa-fw"></i></a>\n    <p class='home-tool-tip'>website</p></div>\n\n    <div><a href=${n.github_url} target='_blank'><i class="fab fa-github"></i></a>\n    <p class='github-tool-tip'>github</p></div>`,j[a].addEventListener("click",async()=>{if(console.log("is it so"),"true"===u)u="false",b[a].classList.add("close-curtain"),b[a].classList.remove("open-curtain"),b[a].lastChild.remove(),j[a].lastChild.remove(),j[a].style.width="80%",j[a].style.padding="6%",j[a].style.margin="0",i.style.margin="0 10% 3% 10%",b[a].style.width="100%",i.classList.remove("project-wrap-click");else if("false"===u){console.log(u),u="true",b[a].classList.add("open-curtain"),b[a].classList.remove("close-curtain"),j[a].appendChild(f),p<900?(j[a].style.flexDirection="column",f.style.width="90%",g.style.width="80%",f.style.marginTop="5%",f.style.background="rgb(240, 253, 253)"):(j[a].style.width="90%",j[a].style.padding="2%",j[a].style.margin="0 auto",i.style.margin="0 1%",b[a].style.width="99%",b[a].style.height="99%"),p<900?(console.log("900-"),r.appendChild(g)):(console.log("900+"),b[a].appendChild(g)),console.log(r),j[a].style.setProperty("--animation","animate-img-wrapper 1.5s linear forwards"),i.classList.add("project-wrap-click")}}),t&&t.isAdmin){const e=Object(o.c)("div","edit-project-wrapper"),t=Object(l.a)("show-edit-button","submit","update");t.addEventListener("click",()=>{console.log(i.lastChild.className),"edit-project-form"!==i.lastChild.className?Object(d.EditProject)(i,n):i.lastChild.remove()}),e.appendChild(t);const a=Object(l.a)("delete-project","submit","delete");a.addEventListener("click",async()=>{let e=confirm(`Are you sure you want to delete ${n.name}?`);e&&await Object(s.b)(n.id),e&&await h()}),e.appendChild(a),i.appendChild(e)}}),t&&t.isAdmin){let t=Object(l.a)("show-add-form","submit","add project");t.addEventListener("click",()=>{console.log(e.lastChild.previousSibling.className),"show-add-form"===e.lastChild.previousSibling.className?Object(d.EditProject)(e,n[0],"addProject"):e.lastChild.remove()}),Object(o.b)(e,t)}e.appendChild(Object(i.a)())}},108:function(e,t,n){"use strict";n.r(t),n.d(t,"EditProject",(function(){return l}));var o=n(3),a=n(101),c=n(102),i=n(105),s=n(0);const l=async(e,t,n)=>{if(console.log("add",n),"addProject"===n)for(let e in t)t[e]="";let l={},d=e=>{console.log(e.target.name,e.target.value),l[e.target.name]=e.target.value,console.log("cmon",l)},r=Object(o.c)("edit-project-form"),h=Object(s.c)("div","edit-form-inputs");r.appendChild(h),Object.keys(t).forEach(e=>{if("id"!==e&&"technologies"!==e&&"created_at"!==e&&"updated_at"!==e){l[e]=t[e];const a=Object(o.d)({className:"edit-form-input",name:e,type:"text",value:"addProject"===n?"":l[e],placeholder:e,handleChange:d});h.appendChild(a)}});const p=Object(s.c)("div","edit-form-checkboxes");r.appendChild(p),(await Object(a.c)()).map(e=>{let a;void 0===n&&t.technologies.forEach(t=>{e.name===t.name&&(console.log(e.name,t.name),a="checked")});let c=Object(o.b)({className:"edit-project-chkbox",name:e.name,id:e.name,value:e.id,checked:"addProject"===n?"":a});p.appendChild(c),p.appendChild(Object(o.e)("tech-box-label",e.name,"tech-box"))}),r.appendChild(Object(o.a)("edit-project-button","submit","addProject"===n?"add new project":"submit")),Object(s.b)(e,r),r.addEventListener("submit",async e=>{e.preventDefault(),console.log("add",n);const o=document.querySelectorAll("input[type=checkbox]:checked");console.log(o,l),l.technologies=[],o.forEach(e=>{l.technologies.push(e.value)}),console.log("add",l),"addProject"===n?await Object(c.a)(l):await Object(c.d)(l,t.id),await Object(i.Projects)()})}},109:function(e,t,n){var o=n(1),a=n(110);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var c={insert:"head",singleton:!1},i=(o(a,c),a.locals?a.locals:{});e.exports=i},110:function(e,t,n){},98:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const o=()=>"https://portfolio-mick-server.herokuapp.com"},99:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l}));var o=n(98);const a=Object(o.a)();const c=async e=>(console.log(JSON.stringify(e)),await fetch(a+"/users",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>(localStorage.setItem("authToken",e.token),e))),i=async e=>{console.log(e);let t=await fetch(a+"/auth/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>(localStorage.setItem("authToken",e.token),e));return console.log(t),t},s=async()=>{if(localStorage.getItem("authToken")){return await fetch(a+"/auth/verify",{method:"get",headers:(e={"Content-Type":"application/json"},localStorage.authToken?{...e,Authorization:`Bearer ${localStorage.authToken}`}:e)}).then(e=>e.json()).then(e=>e)}var e;return!1},l=async()=>(localStorage.removeItem("authToken"),{"Content-Type":"application/json"},"logged out")}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvQ29tcG9uZW50cy9TZXJ2aWNlcy9BcGlUZWNoLmpzIiwid2VicGFjazovLy8uL3NyYy9Db21wb25lbnRzL1NlcnZpY2VzL0FwaVByb2plY3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0NvbXBvbmVudHMvUHJvamVjdHMvUHJvamVjdHMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0NvbXBvbmVudHMvUHJvamVjdHMvRWRpdFByb2plY3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0NvbXBvbmVudHMvUHJvamVjdHMvcHJvamVjdHMuc2NzcyIsIndlYnBhY2s6Ly8vLi9zcmMvQ29tcG9uZW50cy9TZXJ2aWNlcy9CYXNlVXJsLmpzIiwid2VicGFjazovLy8uL3NyYy9Db21wb25lbnRzL1NlcnZpY2VzL0FwaUF1dGguanMiXSwibmFtZXMiOlsiYmFzZVVybCIsImdldFRlY2hub2xvZ2llcyIsImFzeW5jIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwianNvbiIsImFucyIsImNyZWF0ZVRlY2hub2xvZ3kiLCJib2R5IiwibWV0aG9kIiwiSlNPTiIsInN0cmluZ2lmeSIsImhlYWRlcnMiLCJ1cGRhdGVUZWNobm9sb2d5IiwiaWQiLCJkYXRhIiwiZGVsZXRlVGVjaG5vbG9neSIsImdldFByb2plY3RzIiwiYWRkUHJvamVjdCIsImNvbnNvbGUiLCJsb2ciLCJ1cGRhdGVQcm9qZWN0IiwiZGVsZXRlUHJvamVjdCIsImNsZWFyUGFnZSIsImVsZW1lbnQiLCJjaGlsZE5vZGVzIiwibGVuZ3RoIiwicmVtb3ZlQ2hpbGQiLCJsYXN0Q2hpbGQiLCJQcm9qZWN0cyIsIm1haW5Db250ZW50IiwiYXBwZW5kQ2hpbGQiLCJpbm5lckhUTUwiLCJ1c2VyIiwicmVzcCIsImNvbnRhaW5lcldpZHRoIiwiY2xpZW50V2lkdGgiLCJmb3JFYWNoIiwicHJvamVjdCIsImluZGV4IiwicHJvamVjdFdyYXAiLCJpbWFnZSIsImltZ191cmwiLCJuYW1lIiwic2l0ZV91cmwiLCJidWlsZF9kYXRlIiwiYm9vbCIsImxpbmtNb2RhbCIsImltZ1dyYXBwZXIiLCJpbm5lckltZ1dyYXAiLCJ0ZWNoSWNvbnMiLCJ0ZWNobm9sb2dpZXMiLCJpY29uIiwic3JjIiwiaWNvbl91cmwiLCJkZXNjcmlwdGlvbiIsImdpdGh1Yl91cmwiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwic3R5bGUiLCJ3aWR0aCIsInBhZGRpbmciLCJtYXJnaW4iLCJmbGV4RGlyZWN0aW9uIiwibWFyZ2luVG9wIiwiYmFja2dyb3VuZCIsImhlaWdodCIsInNldFByb3BlcnR5IiwiaXNBZG1pbiIsImVkaXRQcm9qZWN0V3JhcHBlciIsImVkaXRCdXR0b24iLCJjbGFzc05hbWUiLCJkZWxldGVCdXR0b24iLCJhbnN3ZXIiLCJjb25maXJtIiwiYWRkQnRuIiwicHJldmlvdXNTaWJsaW5nIiwiRWRpdFByb2plY3QiLCJpdGVtIiwibmV3UHJvamVjdCIsImhhbmRsZUNoYW5nZSIsImUiLCJ0YXJnZXQiLCJ2YWx1ZSIsImZvcm0iLCJpbnB1dHMiLCJPYmplY3QiLCJrZXlzIiwia2V5IiwiaW5wdXQiLCJ0eXBlIiwicGxhY2Vob2xkZXIiLCJjaGVja3MiLCJtYXAiLCJ0ZWNobm9sb2d5IiwiY2hlY2tlZCIsInVuZGVmaW5lZCIsInByb2plY3RUZWNobm9sb2d5IiwiYngiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsImNoZWNrYm94ZXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJib3giLCJwdXNoIiwiYXBpIiwiY29udGVudCIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwibW9kdWxlIiwiaSIsIm9wdGlvbnMiLCJleHBvcnRlZCIsImxvY2FscyIsImV4cG9ydHMiLCJCYXNlVXJsIiwic2lnblVwIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsInRva2VuIiwibG9naW4iLCJ2ZXJpZnkiLCJnZXRJdGVtIiwiYXV0aFRva2VuIiwiQXV0aG9yaXphdGlvbiIsImxvZ291dCIsInJl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U0FBVSxDQUN4Q1UsT0FBUSxPQUNSRyxRQUFTLENBQUUsZUFBZ0Isb0JBQzNCSixLQUFNRSxLQUFLQyxVQUFVSCxLQUVwQkwsS0FBTUUsR0FDRUEsRUFBS0EsUUFFYkYsS0FBTVksSUFFTHlHLGFBQWFDLFFBQVEsWUFBYTFHLEVBQUsyRyxPQUVoQzNHLEtBS0E0RyxFQUFRMUgsTUFBT08sSUFDMUJXLFFBQVFDLElBQUlaLEdBQ1osSUFBSUosUUFBWUYsTUFBTUgsRUFBVSxjQUFlLENBQzdDVSxPQUFRLE9BQ1JHLFFBQVMsQ0FBRSxlQUFnQixvQkFDM0JKLEtBQU1FLEtBQUtDLFVBQVVILEtBRXBCTCxLQUFNRSxHQUNFQSxFQUFLQSxRQUdiRixLQUFNWSxJQUVMeUcsYUFBYUMsUUFBUSxZQUFhMUcsRUFBSzJHLE9BR2hDM0csSUFHWCxPQURBSSxRQUFRQyxJQUFJaEIsR0FDTEEsR0FHSXdILEVBQVMzSCxVQUdwQixHQUZjdUgsYUFBYUssUUFBUSxhQUV4QixDQWNULGFBYmtCM0gsTUFBTUgsRUFBVSxlQUFnQixDQUNoRFUsT0FBUSxNQUNSRyxTQWxFcUJBLEVBa0VELENBQ2xCLGVBQWdCLG9CQWxFbEI0RyxhQUFhTSxVQUNSLElBQ0ZsSCxFQUNIbUgsY0FBZSxVQUFVUCxhQUFhTSxhQUdqQ2xILEtBK0RKVCxLQUFNRSxHQUNFQSxFQUFLQSxRQUViRixLQUFNWSxHQUNFQSxHQTFFUixJQUFvQkgsRUFnRnpCLE9BQU8sR0FzQklvSCxFQUFTL0gsVUFDcEJ1SCxhQUFhUyxXQUFXLGFBQ1gsQ0FDWCxlQUFnQixvQkFFWCIsImZpbGUiOiIxLmY2MjlkZDFhNTcxYzdhZTliMWFmLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQmFzZVVybCB9IGZyb20gJy4vQmFzZVVybC5qcydcbmNvbnN0IGJhc2VVcmwgPSBCYXNlVXJsKClcblxuXG5cblxuZXhwb3J0IGxldCBnZXRUZWNobm9sb2dpZXMgPSBhc3luYyAoKSA9PiB7XG4gIGxldCByZXN1bHRzID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vdGVjaG5vbG9naWVzYClcbiAgICAudGhlbigocmVzKSA9PiB7XG5cbiAgICAgIHJldHVybiByZXMuanNvbigpXG4gICAgfSlcbiAgICAudGhlbigoYW5zKSA9PiB7XG4gICAgICByZXR1cm4gYW5zXG4gICAgfSlcblxuICByZXR1cm4gcmVzdWx0c1xufVxuXG5cbmV4cG9ydCBsZXQgY3JlYXRlVGVjaG5vbG9neSA9IGFzeW5jIChib2R5KSA9PiB7XG4gIGxldCByZXN1bHRzID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vdGVjaG5vbG9naWVzYCwge1xuICAgIG1ldGhvZDogYHBvc3RgLFxuICAgIGJvZHk6SlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfSxcbiAgfSlcbiAgLnRoZW4oKHJlcyk9PntcbiAgICByZXR1cm4gcmVzLmpzb24oKVxuICB9KVxuICAudGhlbigoYW5zKT0+e1xuICAgIHJldHVybiBhbnNcbiAgfSlcbiAgcmV0dXJuIHJlc3VsdHNcbn1cblxuXG5leHBvcnQgY29uc3QgdXBkYXRlVGVjaG5vbG9neSA9IGFzeW5jIChib2R5LCBpZCkgPT4ge1xuICBcbiAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vdGVjaG5vbG9naWVzLyR7aWR9YCwge1xuICAgIG1ldGhvZDogYHB1dGAsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gIH0pXG4gICAgLnRoZW4oKGpzb24pID0+IHtcbiAgICAgIHJldHVybiBqc29uLmpzb24oKVxuICAgIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSlcblxufVxuXG5leHBvcnQgY29uc3QgZGVsZXRlVGVjaG5vbG9neSA9IGFzeW5jKGlkKSA9PiB7XG4gIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS90ZWNobm9sb2dpZXMvJHtpZH1gLHtcbiAgICBtZXRob2Q6IGBkZWxldGVgLFxuICAgIGhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfVxuICB9KVxuICAudGhlbihqc29uPT57XG4gICAgcmV0dXJuIGpzb25cbiAgfSlcbiAgLnRoZW4oZGF0YT0+e1xuICAgIHJldHVybiBkYXRhXG4gIH0pXG59XG5cbiIsImltcG9ydCB7IEJhc2VVcmwgfSBmcm9tICcuL0Jhc2VVcmwuanMnXG5jb25zdCBiYXNlVXJsID0gQmFzZVVybCgpXG5cblxuZXhwb3J0IGxldCBnZXRQcm9qZWN0cyA9IGFzeW5jICgpID0+IHtcbiAgbGV0IHJlc3VsdHMgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9wcm9qZWN0c2ApXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuXG4gICAgICByZXR1cm4gcmVzLmpzb24oKVxuICAgIH0pXG4gICAgLnRoZW4oKGFucykgPT4ge1xuICAgICAgcmV0dXJuIGFuc1xuICAgIH0pXG5cbiAgcmV0dXJuIHJlc3VsdHNcbn1cblxuZXhwb3J0IGxldCBnZXRQcm9qZWN0ID0gYXN5bmMgKGlkKSA9PiB7XG4gIGxldCByZXN1bHQgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9wcm9qZWN0cy8ke2lkfWApXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuXG4gICAgICByZXR1cm4gcmVzLmpzb24oKVxuICAgIH0pXG4gICAgLnRoZW4oKGFucykgPT4ge1xuICAgICAgcmV0dXJuIGFuc1xuICAgIH0pXG5cbiAgcmV0dXJuIHJlc3VsdFxufVxuXG5cblxuZXhwb3J0IGNvbnN0IGFkZFByb2plY3QgPSBhc3luYyAoYm9keSkgPT4ge1xuIFxuIFxuICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9wcm9qZWN0c2AsIHtcbiAgICBtZXRob2Q6IGBwb3N0YCxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcbiAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgfSlcbiAgICAudGhlbigoanNvbikgPT4ge1xuICAgICAgcmV0dXJuIGpzb24uanNvbigpXG4gICAgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9KVxuICBjb25zb2xlLmxvZyhyZXMpXG59XG5cblxuZXhwb3J0IGNvbnN0IHVwZGF0ZVByb2plY3QgPSBhc3luYyAoYm9keSwgaWQpID0+IHtcbiAgXG4gIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L3Byb2plY3RzLyR7aWR9YCwge1xuICAgIG1ldGhvZDogYHB1dGAsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gIH0pXG4gICAgLnRoZW4oKGpzb24pID0+IHtcbiAgICAgIHJldHVybiBqc29uLmpzb24oKVxuICAgIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSlcblxufVxuLy9cbmV4cG9ydCBjb25zdCBkZWxldGVQcm9qZWN0ID0gYXN5bmMgKGlkKSA9PiB7XG5cblxuXG4gIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L3Byb2plY3RzLyR7aWR9YCwge1xuICAgIG1ldGhvZDogYGRlbGV0ZWAsXG4gICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cbiAgfSlcbiAgICAudGhlbigoanNvbikgPT4ge1xuICAgICAgcmV0dXJuIGpzb24uanNvbigpXG4gICAgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9KVxuICBjb25zb2xlLmxvZyhyZXMpXG59XG5cblxuZXhwb3J0IGNvbnN0IHVwZGF0ZVByb2plY3RUZWNobm9sb2dpZXMgPSBhc3luYyAocHJvamVjdF9pZCwgaWQpID0+IHtcbiAgY29uc29sZS5sb2coJ3VwdCcpXG4gIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGAke2Jhc2VVcmx9L3Byb2plY3RzLyR7cHJvamVjdF9pZH0vdGVjaG5vbG9naWVzLyR7aWR9YCwge1xuICAgIG1ldGhvZDogYHB1dGAsXG4gICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cbiAgfSlcbiAgICAudGhlbigoanNvbikgPT4ge1xuICAgICAgcmV0dXJuIGpzb24uanNvbigpXG4gICAgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9KVxuICBjb25zb2xlLmxvZyhyZXMpXG5cbn0iLCIvLyBpbXBvcnQgXCIuLi9TaGFyZWQvSW1hZ2VcIlxuaW1wb3J0IHsgcXMsIHFzYSwgY2VjbCwgYWMsIGJ0biB9IGZyb20gXCIuLi9IZWxwZXJzL2RvbUhlbHBlclwiXG5pbXBvcnQgeyB2ZXJpZnkgfSBmcm9tIFwiLi4vU2VydmljZXMvQXBpQXV0aC5qc1wiXG5pbXBvcnQgeyBJbWFnZSB9IGZyb20gXCIuLi9TaGFyZWQvSW1hZ2UuanNcIlxuaW1wb3J0IHsgRm9vdGVyIH0gZnJvbSBcIi4uL0Zvb3Rlci9Gb290ZXIuanNcIlxuaW1wb3J0IHtcbiAgZ2V0UHJvamVjdHMsXG4gIGRlbGV0ZVByb2plY3QsXG5cbn0gZnJvbSBcIi4uL1NlcnZpY2VzL0FwaVByb2plY3QuanNcIlxuaW1wb3J0IHsgRm9ybSwgSW5wdXQsIEJ1dHRvbiwgQ2hlY2tib3gsIExhYmVsIH0gZnJvbSBcIi4uL1NoYXJlZC9Gb3JtLmpzXCJcbmltcG9ydCB7IEVkaXRQcm9qZWN0IH0gZnJvbSBcIi4vRWRpdFByb2plY3RcIlxuaW1wb3J0IFwiLi9wcm9qZWN0cy5zY3NzXCJcblxuLyoqKioqKioqKipcbiBDTEVBUiBQQUdFXG4qKioqKioqKioqKi9cbmNvbnN0IGNsZWFyUGFnZSA9IChlbGVtZW50KSA9PiB7XG4gIHdoaWxlIChlbGVtZW50LmNoaWxkTm9kZXMubGVuZ3RoKSB7XG4gICAgZWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50Lmxhc3RDaGlsZClcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUHJvamVjdHMoKSB7XG5cbiAgY29uc3QgbWFpbkNvbnRlbnQgPSBxcygnLnNjcm9sbGFibGUtY29udGVudCcpXG4gIGNsZWFyUGFnZShtYWluQ29udGVudClcbiAgbGV0IGxvYWRpbmcgPSBtYWluQ29udGVudC5hcHBlbmRDaGlsZChjZWNsKFwiZGl2XCIsIFwibG9hZGluZ1wiKSlcbiAgbG9hZGluZy5pbm5lckhUTUwgPSBcImxvYWRpbmcuLi5cIlxuICBjb25zdCB1c2VyID0gYXdhaXQgdmVyaWZ5KClcblxuXG4gIC8qKioqKioqKioqKioqKlxuICBSRU5ERVIgUFJPSkVDVFNcbiAgKioqKioqKioqKioqKioqL1xuICBjb25zdCByZXNwID0gYXdhaXQgZ2V0UHJvamVjdHMoKVxuICBjbGVhclBhZ2UobWFpbkNvbnRlbnQpXG5cbiAgY29uc3QgY29udGFpbmVyV2lkdGggPSBtYWluQ29udGVudC5jbGllbnRXaWR0aFxuICByZXNwLmZvckVhY2goYXN5bmMgKHByb2plY3QsIGluZGV4KSA9PiB7XG5cbiAgICBjb25zdCBwcm9qZWN0V3JhcCA9IG1haW5Db250ZW50LmFwcGVuZENoaWxkKGNlY2woXCJkaXZcIiwgXCJwcm9qZWN0LXdyYXBcIikpXG4gICAgY29uc3QgaW1hZ2UgPSBwcm9qZWN0V3JhcC5hcHBlbmRDaGlsZChcbiAgICAgIEltYWdlKGBzcmMvaW1nLyR7cHJvamVjdC5pbWdfdXJsfWAsIHByb2plY3QubmFtZSwgdHJ1ZSwgcHJvamVjdC5zaXRlX3VybCwgcHJvamVjdC5idWlsZF9kYXRlKVxuICAgIClcbiAgIFxuICAgIGxldCBib29sID0gXCJmYWxzZVwiXG4gICAgbGV0IGxpbmtNb2RhbCA9IGNlY2woXCJkaXZcIiwgXCJsaW5rLW1vZGFsXCIpXG4gICAgbGV0IGltZ1dyYXBwZXIgPSBxc2EoXCIuaW1nLXdyYXBwZXJcIilcbiAgICBsZXQgaW5uZXJJbWdXcmFwID0gcXNhKFwiLmlubmVyLWltZy13cmFwXCIpXG4gICAgbGV0IHRlY2hJY29ucyA9IGNlY2woXCJkaXZcIiwgXCJ0ZWNoLWljb25zXCIpXG4gICAgcHJvamVjdC50ZWNobm9sb2dpZXMuZm9yRWFjaCgoaWNvbikgPT4ge1xuICAgICAgbGV0IHRlY2hJY29uID0gdGVjaEljb25zLmFwcGVuZENoaWxkKGNlY2woXCJpbWdcIiwgXCJ0ZWNoLWljb25cIikpXG4gICAgICB0ZWNoSWNvbi5zcmMgPSBgc3JjL2ltZy8ke2ljb24uaWNvbl91cmx9YFxuICAgIH0pXG4gICAgbGV0IGRlc2NyaXB0aW9uID0gY2VjbCgnZGl2JywgJ2Rlc2NyaXB0aW9uJylcbiAgICBkZXNjcmlwdGlvbi5pbm5lckhUTUwgPSBwcm9qZWN0LmRlc2NyaXB0aW9uXG5cbiAgICBpZiAoY29udGFpbmVyV2lkdGggPCA5MDApIHtcbiAgICAgIGxpbmtNb2RhbC5hcHBlbmRDaGlsZCh0ZWNoSWNvbnMpXG4gICAgICBsaW5rTW9kYWwuYXBwZW5kQ2hpbGQoZGVzY3JpcHRpb24pXG4gICAgfSBlbHNlIHtcbiAgICAgIGxpbmtNb2RhbC5hcHBlbmRDaGlsZChkZXNjcmlwdGlvbilcbiAgICAgIGxpbmtNb2RhbC5hcHBlbmRDaGlsZCh0ZWNoSWNvbnMpXG4gICAgfVxuXG4gICAgY29uc3QgbGlua01vZGFsSWNvbnMgPSBsaW5rTW9kYWwuYXBwZW5kQ2hpbGQoY2VjbCgnZGl2JywgJ2xpbmstbW9kYWwtaWNvbnMnKSlcblxuICAgIGxpbmtNb2RhbEljb25zLmlubmVySFRNTCA9XG4gICAgICBgPGRpdj48YSBocmVmPSR7cHJvamVjdC5zaXRlX3VybH0gdGFyZ2V0PSdfYmxhbmsnPjxpIGNsYXNzPVwiZmFzIGZhLWhvbWUgZmEtZndcIj48L2k+PC9hPlxuICAgIDxwIGNsYXNzPSdob21lLXRvb2wtdGlwJz53ZWJzaXRlPC9wPjwvZGl2PlxuXG4gICAgPGRpdj48YSBocmVmPSR7cHJvamVjdC5naXRodWJfdXJsfSB0YXJnZXQ9J19ibGFuayc+PGkgY2xhc3M9XCJmYWIgZmEtZ2l0aHViXCI+PC9pPjwvYT5cbiAgICA8cCBjbGFzcz0nZ2l0aHViLXRvb2wtdGlwJz5naXRodWI8L3A+PC9kaXY+YFxuXG5cbiAgICAvKioqKioqKioqKioqKipcbiAgICBBREQgTElOSyBNT0RBTFxuICAgICoqKioqKioqKioqKioqKi9cbiAgICBpbWdXcmFwcGVyW2luZGV4XS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnaXMgaXQgc28nKVxuICAgICBcbiAgICAgIGlmIChib29sID09PSBcInRydWVcIikge1xuICAgICAgICBib29sID0gXCJmYWxzZVwiXG4gICAgICAgIGlubmVySW1nV3JhcFtpbmRleF0uY2xhc3NMaXN0LmFkZChcImNsb3NlLWN1cnRhaW5cIilcbiAgICAgICAgaW5uZXJJbWdXcmFwW2luZGV4XS5jbGFzc0xpc3QucmVtb3ZlKFwib3Blbi1jdXJ0YWluXCIpXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGxhc3RDaGlsZClcbiAgICAgICAgaW5uZXJJbWdXcmFwW2luZGV4XS5sYXN0Q2hpbGQucmVtb3ZlKClcbiAgICAgICAgaW1nV3JhcHBlcltpbmRleF0ubGFzdENoaWxkLnJlbW92ZSgpXG5cblxuICAgICAgICBpbWdXcmFwcGVyW2luZGV4XS5zdHlsZS53aWR0aCA9ICc4MCUnXG4gICAgICAgIGltZ1dyYXBwZXJbaW5kZXhdLnN0eWxlLnBhZGRpbmcgPSAnNiUnXG4gICAgICAgIGltZ1dyYXBwZXJbaW5kZXhdLnN0eWxlLm1hcmdpbiA9ICcwJ1xuXG4gICAgICAgIHByb2plY3RXcmFwLnN0eWxlLm1hcmdpbiA9ICcwIDEwJSAzJSAxMCUnXG4gICAgICAgIGlubmVySW1nV3JhcFtpbmRleF0uc3R5bGUud2lkdGggPSAnMTAwJSdcblxuICAgICAgICBwcm9qZWN0V3JhcC5jbGFzc0xpc3QucmVtb3ZlKFwicHJvamVjdC13cmFwLWNsaWNrXCIpXG5cbiAgICAgIFxuXG4gICAgICB9IGVsc2UgaWYgKGJvb2wgPT09IFwiZmFsc2VcIikge1xuICAgICAgICBjb25zb2xlLmxvZyhib29sKVxuICAgICAgICBib29sID0gXCJ0cnVlXCJcbiAgICAgICAgaW5uZXJJbWdXcmFwW2luZGV4XS5jbGFzc0xpc3QuYWRkKFwib3Blbi1jdXJ0YWluXCIpXG4gICAgICAgIGlubmVySW1nV3JhcFtpbmRleF0uY2xhc3NMaXN0LnJlbW92ZShcImNsb3NlLWN1cnRhaW5cIilcbiAgICAgICAgaW1nV3JhcHBlcltpbmRleF0uYXBwZW5kQ2hpbGQobGlua01vZGFsKVxuXG5cbiAgICAgICAgaWYgKGNvbnRhaW5lcldpZHRoIDwgOTAwKSB7XG4gICAgICAgICAgaW1nV3JhcHBlcltpbmRleF0uc3R5bGUuZmxleERpcmVjdGlvbiA9ICdjb2x1bW4nXG4gICAgICAgICAgbGlua01vZGFsLnN0eWxlLndpZHRoID0gJzkwJSdcbiAgICAgICAgICB0ZWNoSWNvbnMuc3R5bGUud2lkdGggPSAnODAlJ1xuICAgICAgICAgIGxpbmtNb2RhbC5zdHlsZS5tYXJnaW5Ub3AgPSAnNSUnXG4gICAgICAgICAgbGlua01vZGFsLnN0eWxlLmJhY2tncm91bmQgPSAncmdiKDI0MCwgMjUzLCAyNTMpJ1xuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgaW1nV3JhcHBlcltpbmRleF0uc3R5bGUud2lkdGggPSAnOTAlJ1xuICAgICAgICAgIGltZ1dyYXBwZXJbaW5kZXhdLnN0eWxlLnBhZGRpbmcgPSAnMiUnXG4gICAgICAgICAgaW1nV3JhcHBlcltpbmRleF0uc3R5bGUubWFyZ2luID0gJzAgYXV0bydcbiAgICAgICAgICBwcm9qZWN0V3JhcC5zdHlsZS5tYXJnaW4gPSAnMCAxJSdcblxuICAgICAgICAgIGlubmVySW1nV3JhcFtpbmRleF0uc3R5bGUud2lkdGggPSAnOTklJ1xuICAgICAgICAgIGlubmVySW1nV3JhcFtpbmRleF0uc3R5bGUuaGVpZ2h0ID0gJzk5JSdcbiAgICAgICAgICAvLyBcbiAgICAgICAgfVxuXG5cbiAgICAgICAgaWYgKGNvbnRhaW5lcldpZHRoIDwgOTAwKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJzkwMC0nKVxuICAgICAgICAgIGltYWdlLmFwcGVuZENoaWxkKHRlY2hJY29ucylcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnOTAwKycpXG4gICAgICAgICAgaW5uZXJJbWdXcmFwW2luZGV4XS5hcHBlbmRDaGlsZCh0ZWNoSWNvbnMpXG5cbiAgICAgICAgfVxuXG5cblxuICAgICAgICBjb25zb2xlLmxvZyhpbWFnZSlcblxuICAgICAgICBsZXQgaXcgPSBpbWdXcmFwcGVyW2luZGV4XS5zdHlsZVxuICAgICAgICBpdy5zZXRQcm9wZXJ0eShcbiAgICAgICAgICBcIi0tYW5pbWF0aW9uXCIsXG4gICAgICAgICAgXCJhbmltYXRlLWltZy13cmFwcGVyIDEuNXMgbGluZWFyIGZvcndhcmRzXCJcbiAgICAgICAgKVxuICAgICAgICBwcm9qZWN0V3JhcC5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC13cmFwLWNsaWNrXCIpXG5cbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKipcbiAgICAgRURJVCBQUk9KRUNUIEJVVFRPTlxuICAgICoqKioqKioqKioqKioqKioqKioqL1xuICAgXG4gICAgaWYgKHVzZXIgJiYgdXNlci5pc0FkbWluKSB7XG5cbiAgICAgIGNvbnN0IGVkaXRQcm9qZWN0V3JhcHBlciA9IGNlY2woXCJkaXZcIiwgXCJlZGl0LXByb2plY3Qtd3JhcHBlclwiKVxuICAgICAgY29uc3QgZWRpdEJ1dHRvbiA9IEJ1dHRvbihcInNob3ctZWRpdC1idXR0b25cIiwgXCJzdWJtaXRcIiwgXCJ1cGRhdGVcIilcbiAgICAgIGVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2cocHJvamVjdFdyYXAubGFzdENoaWxkLmNsYXNzTmFtZSlcbiAgICAgICAgaWYgKFxuICAgICAgICAgIHByb2plY3RXcmFwLmxhc3RDaGlsZC5jbGFzc05hbWUgIT09IFwiZWRpdC1wcm9qZWN0LWZvcm1cIlxuICAgICAgICApXG4gICAgICAgICAgRWRpdFByb2plY3QocHJvamVjdFdyYXAsIHByb2plY3QpXG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHByb2plY3RXcmFwLmxhc3RDaGlsZC5yZW1vdmUoKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgZWRpdFByb2plY3RXcmFwcGVyLmFwcGVuZENoaWxkKGVkaXRCdXR0b24pXG5cbiAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICBERUxFVEUgUFJPSkVDVCBCVVRUT05cbiAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IEJ1dHRvbihcImRlbGV0ZS1wcm9qZWN0XCIsIFwic3VibWl0XCIsIFwiZGVsZXRlXCIpXG4gICAgICBkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgbGV0IGFuc3dlciA9IGNvbmZpcm0oYEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgJHtwcm9qZWN0Lm5hbWV9P2ApXG4gICAgICAgIGFuc3dlciAmJiBhd2FpdCBkZWxldGVQcm9qZWN0KHByb2plY3QuaWQpXG4gICAgICAgIGFuc3dlciAmJiBhd2FpdCBQcm9qZWN0cygpXG4gICAgICB9KVxuICAgICAgZWRpdFByb2plY3RXcmFwcGVyLmFwcGVuZENoaWxkKGRlbGV0ZUJ1dHRvbilcbiAgICAgIHByb2plY3RXcmFwLmFwcGVuZENoaWxkKGVkaXRQcm9qZWN0V3JhcHBlcilcbiAgICB9XG4gIH0pXG5cbiAgLyoqKioqKioqKioqXG4gIEFERCBQUk9KRUNUIFxuICAqKioqKioqKioqKiovXG4gIGlmICh1c2VyICYmIHVzZXIuaXNBZG1pbikge1xuXG4gICAgbGV0IGFkZEJ0biA9IEJ1dHRvbihcInNob3ctYWRkLWZvcm1cIiwgXCJzdWJtaXRcIiwgXCJhZGQgcHJvamVjdFwiKVxuICAgIGFkZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2cobWFpbkNvbnRlbnQubGFzdENoaWxkLnByZXZpb3VzU2libGluZy5jbGFzc05hbWUpXG4gICAgICBpZiAobWFpbkNvbnRlbnQubGFzdENoaWxkLnByZXZpb3VzU2libGluZy5jbGFzc05hbWUgPT09IFwic2hvdy1hZGQtZm9ybVwiKVxuICAgICAgICBFZGl0UHJvamVjdChtYWluQ29udGVudCwgcmVzcFswXSwgXCJhZGRQcm9qZWN0XCIpXG4gICAgICBlbHNlIHtcbiAgICAgICAgbWFpbkNvbnRlbnQubGFzdENoaWxkLnJlbW92ZSgpXG4gICAgICB9XG4gICAgfSlcblxuICAgIGFjKG1haW5Db250ZW50LCBhZGRCdG4pXG4gIH1cblxuICBtYWluQ29udGVudC5hcHBlbmRDaGlsZChGb290ZXIoKSlcblxuXG59XG4iLCJpbXBvcnQgeyBGb3JtLCBJbnB1dCwgQnV0dG9uLCBDaGVja2JveCwgTGFiZWwgfSBmcm9tIFwiLi4vU2hhcmVkL0Zvcm0uanNcIlxuaW1wb3J0IHsgZ2V0VGVjaG5vbG9naWVzIH0gZnJvbSBcIi4uL1NlcnZpY2VzL0FwaVRlY2guanNcIlxuaW1wb3J0IHtcbiAgZ2V0UHJvamVjdCxcbiAgYWRkUHJvamVjdCBhcyBhZGROZXdQcm9qZWN0LFxuICB1cGRhdGVQcm9qZWN0LFxuICBkZWxldGVQcm9qZWN0LFxuICB1cGRhdGVQcm9qZWN0VGVjaG5vbG9naWVzLFxufSBmcm9tIFwiLi4vU2VydmljZXMvQXBpUHJvamVjdC5qc1wiXG5pbXBvcnQgeyBQcm9qZWN0cyB9IGZyb20gXCIuL1Byb2plY3RzLmpzXCJcbmltcG9ydCB7IGFjLCBjZWNsIH0gZnJvbSBcIi4uL0hlbHBlcnMvZG9tSGVscGVyLmpzXCJcblxuZXhwb3J0IGNvbnN0IEVkaXRQcm9qZWN0ID0gYXN5bmMgKHByb2plY3RXcmFwLCBwcm9qZWN0LCBhZGRQcm9qZWN0KSA9PiB7XG4gIC8qKioqKioqKioqKioqKioqKioqKioqKipcbiAgTUFLRSBBTkQgU0VUIEZPUk0gIElOUFVUU1xuICAqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICBjb25zb2xlLmxvZyhcImFkZFwiLCBhZGRQcm9qZWN0KVxuICBpZiAoYWRkUHJvamVjdCA9PT0gXCJhZGRQcm9qZWN0XCIpIHtcbiAgICBmb3IgKGxldCBpdGVtIGluIHByb2plY3QpIHtcbiAgICAgIHByb2plY3RbaXRlbV0gPSBcIlwiXG4gICAgfVxuICB9XG4gIGxldCBuZXdQcm9qZWN0ID0ge31cblxuICBsZXQgaGFuZGxlQ2hhbmdlID0gKGUpID0+IHtcbiAgICBjb25zb2xlLmxvZyhlLnRhcmdldC5uYW1lLCBlLnRhcmdldC52YWx1ZSlcbiAgICBuZXdQcm9qZWN0W2UudGFyZ2V0Lm5hbWVdID0gZS50YXJnZXQudmFsdWVcbiAgICBjb25zb2xlLmxvZygnY21vbicsIG5ld1Byb2plY3QpXG4gIH1cblxuICBsZXQgZm9ybSA9IEZvcm0oXCJlZGl0LXByb2plY3QtZm9ybVwiKVxuICBsZXQgaW5wdXRzID0gY2VjbCgnZGl2JywgJ2VkaXQtZm9ybS1pbnB1dHMnKVxuICBmb3JtLmFwcGVuZENoaWxkKGlucHV0cylcbiAgT2JqZWN0LmtleXMocHJvamVjdCkuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgaWYgKFxuICAgICAga2V5ICE9PSBcImlkXCIgJiZcbiAgICAgIGtleSAhPT0gXCJ0ZWNobm9sb2dpZXNcIiAmJlxuICAgICAga2V5ICE9PSBcImNyZWF0ZWRfYXRcIiAmJlxuICAgICAga2V5ICE9PSBcInVwZGF0ZWRfYXRcIlxuICAgICkge1xuICAgICAgbmV3UHJvamVjdFtrZXldID0gcHJvamVjdFtrZXldXG4gICAgICBjb25zdCBpbnB1dCA9IElucHV0KHtcbiAgICAgICAgY2xhc3NOYW1lOiBcImVkaXQtZm9ybS1pbnB1dFwiLFxuICAgICAgICBuYW1lOiBrZXksXG4gICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICB2YWx1ZTogYWRkUHJvamVjdCA9PT0gXCJhZGRQcm9qZWN0XCIgPyBcIlwiIDogbmV3UHJvamVjdFtrZXldLFxuICAgICAgICBwbGFjZWhvbGRlcjoga2V5LFxuICAgICAgICBoYW5kbGVDaGFuZ2U6IGhhbmRsZUNoYW5nZSxcbiAgICAgIH0pXG4gICAgICBpbnB1dHMuYXBwZW5kQ2hpbGQoaW5wdXQpXG4gICAgfVxuICB9KVxuXG4gIC8qKioqKioqKioqKioqKlxuICAgU0VUIENIRUNLQk9YRVNcbiAgKioqKioqKioqKioqKioqL1xuICBjb25zdCBjaGVja3MgPSBjZWNsKCdkaXYnLCAnZWRpdC1mb3JtLWNoZWNrYm94ZXMnKVxuICBmb3JtLmFwcGVuZENoaWxkKGNoZWNrcylcbiAgbGV0IHRlY2hub2xvZ2llcyA9IGF3YWl0IGdldFRlY2hub2xvZ2llcygpXG4gIHRlY2hub2xvZ2llcy5tYXAoKHRlY2hub2xvZ3kpID0+IHtcblxuICAgIGxldCBjaGVja2VkXG4gICAgYWRkUHJvamVjdCA9PT0gdW5kZWZpbmVkICYmXG4gICAgICBwcm9qZWN0LnRlY2hub2xvZ2llcy5mb3JFYWNoKChwcm9qZWN0VGVjaG5vbG9neSkgPT4ge1xuICAgICAgICBpZiAodGVjaG5vbG9neS5uYW1lID09PSBwcm9qZWN0VGVjaG5vbG9neS5uYW1lKSB7XG4gICAgICAgICAgY29uc29sZS5sb2codGVjaG5vbG9neS5uYW1lLCBwcm9qZWN0VGVjaG5vbG9neS5uYW1lKVxuICAgICAgICAgIGNoZWNrZWQgPSBcImNoZWNrZWRcIlxuICAgICAgICB9XG4gICAgICB9KVxuICAgIGxldCBieCA9IENoZWNrYm94KHtcbiAgICAgIGNsYXNzTmFtZTogXCJlZGl0LXByb2plY3QtY2hrYm94XCIsXG4gICAgICBuYW1lOiB0ZWNobm9sb2d5Lm5hbWUsXG4gICAgICBpZDogdGVjaG5vbG9neS5uYW1lLFxuICAgICAgdmFsdWU6IHRlY2hub2xvZ3kuaWQsXG4gICAgICBjaGVja2VkOiBhZGRQcm9qZWN0ID09PSBcImFkZFByb2plY3RcIiA/IFwiXCIgOiBjaGVja2VkLFxuXG4gICAgfSlcbiAgICBjaGVja3MuYXBwZW5kQ2hpbGQoYngpXG4gICAgY2hlY2tzLmFwcGVuZENoaWxkKExhYmVsKFwidGVjaC1ib3gtbGFiZWxcIiwgdGVjaG5vbG9neS5uYW1lLCBcInRlY2gtYm94XCIpKVxuXG4gIH0pXG4gIGZvcm0uYXBwZW5kQ2hpbGQoXG4gICAgQnV0dG9uKFxuICAgICAgXCJlZGl0LXByb2plY3QtYnV0dG9uXCIsXG4gICAgICBcInN1Ym1pdFwiLFxuICAgICAgYWRkUHJvamVjdCA9PT0gXCJhZGRQcm9qZWN0XCIgPyBcImFkZCBuZXcgcHJvamVjdFwiIDogXCJzdWJtaXRcIlxuICAgIClcbiAgKVxuXG5cbiAgYWMocHJvamVjdFdyYXAsIGZvcm0pXG5cblxuICAvKioqKioqKioqKlxuICAgU1VCTUlUIEZPUk1cbiAgKioqKioqKioqKiovXG4gIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBhc3luYyAoZXZ0KSA9PiB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KClcbiAgICBjb25zb2xlLmxvZyhcImFkZFwiLCBhZGRQcm9qZWN0KVxuXG4gICAgY29uc3QgY2hlY2tib3hlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFt0eXBlPWNoZWNrYm94XTpjaGVja2VkXCIpXG4gICAgY29uc29sZS5sb2coY2hlY2tib3hlcywgbmV3UHJvamVjdClcbiAgICBuZXdQcm9qZWN0LnRlY2hub2xvZ2llcyA9IFtdXG4gICAgY2hlY2tib3hlcy5mb3JFYWNoKChib3gpID0+IHtcbiAgICAgIG5ld1Byb2plY3QudGVjaG5vbG9naWVzLnB1c2goYm94LnZhbHVlKVxuICAgIH0pXG4gICAgY29uc29sZS5sb2coXCJhZGRcIiwgbmV3UHJvamVjdClcbiAgICBhZGRQcm9qZWN0ID09PSBcImFkZFByb2plY3RcIlxuICAgICAgPyBhd2FpdCBhZGROZXdQcm9qZWN0KG5ld1Byb2plY3QpXG4gICAgICA6IGF3YWl0IHVwZGF0ZVByb2plY3QobmV3UHJvamVjdCwgcHJvamVjdC5pZClcblxuICAgIGF3YWl0IFByb2plY3RzKClcbiAgfSlcbn1cbiIsInZhciBhcGkgPSByZXF1aXJlKFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL21pbmktY3NzLWV4dHJhY3QtcGx1Z2luL2Rpc3QvbG9hZGVyLmpzIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9kaXN0L2Nqcy5qcyEuL3Byb2plY3RzLnNjc3NcIik7XG5cbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50Ll9fZXNNb2R1bGUgPyBjb250ZW50LmRlZmF1bHQgOiBjb250ZW50O1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbiAgICAgICAgICAgIH1cblxudmFyIG9wdGlvbnMgPSB7fTtcblxub3B0aW9ucy5pbnNlcnQgPSBcImhlYWRcIjtcbm9wdGlvbnMuc2luZ2xldG9uID0gZmFsc2U7XG5cbnZhciB1cGRhdGUgPSBhcGkoY29udGVudCwgb3B0aW9ucyk7XG5cbnZhciBleHBvcnRlZCA9IGNvbnRlbnQubG9jYWxzID8gY29udGVudC5sb2NhbHMgOiB7fTtcblxuXG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0ZWQ7IiwiXG5leHBvcnQgY29uc3QgQmFzZVVybCA9ICgpID0+IHtcblxuICAgIHJldHVybiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8gJ2h0dHBzOi8vcG9ydGZvbGlvLW1pY2stc2VydmVyLmhlcm9rdWFwcC5jb20nIDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCdcblxufSIsImltcG9ydCB7IEJhc2VVcmwgfSBmcm9tIFwiLi9CYXNlVXJsLmpzXCJcbmNvbnN0IGJhc2VVcmwgPSBCYXNlVXJsKClcblxuZXhwb3J0IGZ1bmN0aW9uIHNldEhlYWRlcnMoaGVhZGVycykge1xuICBpZiAobG9jYWxTdG9yYWdlLmF1dGhUb2tlbikge1xuICAgIHJldHVybiB7XG4gICAgICAuLi5oZWFkZXJzLFxuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2xvY2FsU3RvcmFnZS5hdXRoVG9rZW59YCxcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGhlYWRlcnNcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgY2xlYXJIZWFkZXJzID0gKGhlYWRlcnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5oZWFkZXJzLFxuICAgIEF1dGhvcml6YXRpb246IG51bGwsXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHNpZ25VcCA9IGFzeW5jIChib2R5KSA9PiB7XG4gIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGJvZHkpKVxuXG4gIGxldCByZXMgPSBhd2FpdCBmZXRjaChiYXNlVXJsICsgXCIvdXNlcnNcIiwge1xuICAgIG1ldGhvZDogXCJwb3N0XCIsXG4gICAgaGVhZGVyczogeyBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICB9KVxuICAgIC50aGVuKChqc29uKSA9PiB7XG4gICAgICByZXR1cm4ganNvbi5qc29uKClcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG5cbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYXV0aFRva2VuXCIsIGRhdGEudG9rZW4pXG5cbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSlcbiAgcmV0dXJuIHJlc1xufVxuXG5leHBvcnQgY29uc3QgbG9naW4gPSBhc3luYyAoYm9keSkgPT4ge1xuICBjb25zb2xlLmxvZyhib2R5KVxuICBsZXQgcmVzID0gYXdhaXQgZmV0Y2goYmFzZVVybCArIFwiL2F1dGgvbG9naW5cIiwge1xuICAgIG1ldGhvZDogXCJwb3N0XCIsXG4gICAgaGVhZGVyczogeyBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICB9KVxuICAgIC50aGVuKChqc29uKSA9PiB7XG4gICAgICByZXR1cm4ganNvbi5qc29uKClcblxuICAgIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImF1dGhUb2tlblwiLCBkYXRhLnRva2VuKVxuXG5cbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSlcbiAgY29uc29sZS5sb2cocmVzKVxuICByZXR1cm4gcmVzXG59XG5cbmV4cG9ydCBjb25zdCB2ZXJpZnkgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJhdXRoVG9rZW5cIilcbiAgLy8gY29uc29sZS5sb2codG9rZW4pXG4gIGlmICh0b2tlbikge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGJhc2VVcmwgKyBcIi9hdXRoL3ZlcmlmeVwiLCB7XG4gICAgICBtZXRob2Q6IFwiZ2V0XCIsXG4gICAgICBoZWFkZXJzOiBzZXRIZWFkZXJzKHtcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKGpzb24pID0+IHtcbiAgICAgICAgcmV0dXJuIGpzb24uanNvbigpXG4gICAgICB9KVxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgIH0pXG5cbiAgICByZXR1cm4gcmVzXG4gIH1cblxuICByZXR1cm4gZmFsc2Vcbn1cblxuZXhwb3J0IGNvbnN0IGdldEN1cnJlbnRVc2VyID0gYXN5bmMgKCkgPT4ge1xuICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJhdXRoVG9rZW5cIikpIHtcbiAgICAvLyBjb25zb2xlLmxvZyhcImhlcmVcIiwgbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJhdXRoVG9rZW5cIikpXG4gICAgbGV0IHVzZXIgPSBhd2FpdCB2ZXJpZnkoKVxuICAgIGNvbnNvbGUubG9nKHVzZXIpXG4gICAgaWYgKCF1c2VyLmVycm9ycykge1xuICAgICAgLy8gbG9naW5CdXR0b24uaW5uZXJUZXh0ID0gXCJsb2dvdXRcIlxuICAgICAgLy8gbG9nZ2VkSW4gPSB0cnVlXG4gICAgICByZXR1cm4gdXNlclxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICAvLyBsb2dpbkJ1dHRvbi5pbm5lclRleHQgPSBcImxvZ2luXCJcblxuICAgIC8vIGxvZ2dlZEluID0gZmFsc2VcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuICBjb25zb2xlLmxvZyhsb2dnZWRJbilcbn1cblxuZXhwb3J0IGNvbnN0IGxvZ291dCA9IGFzeW5jICgpID0+IHtcbiAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJhdXRoVG9rZW5cIilcbiAgY2xlYXJIZWFkZXJzKHtcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSlcbiAgcmV0dXJuIFwibG9nZ2VkIG91dFwiXG59XG4iXSwic291cmNlUm9vdCI6IiJ9