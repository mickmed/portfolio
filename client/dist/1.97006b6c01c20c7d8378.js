(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{100:function(e,t,n){"use strict";n.r(t),n.d(t,"Projects",(function(){return p}));var o=n(0),a=n(94),c=n(95),i=n(4),s=n(97),l=n(3),d=n(103);n(104);const r=e=>{for(;e.childNodes.length;)e.removeChild(e.lastChild)};async function p(){const e=Object(o.e)(".scrollable-content");r(e),e.appendChild(Object(o.c)("div","loading")).innerHTML="loading...";const t=await Object(a.d)(),n=await Object(s.c)();r(e);const h=e.clientWidth;if(n.forEach(async(n,a)=>{const i=e.appendChild(Object(o.c)("div","project-wrap")),r=i.appendChild(Object(c.a)(`src/img/${n.img_url}`,n.name,!0,n.site_url,n.build_date));let u="false",j=Object(o.c)("div","link-modal"),b=Object(o.f)(".img-wrapper"),f=Object(o.f)(".inner-img-wrap"),m=Object(o.c)("div","tech-icons");n.technologies.forEach(e=>{m.appendChild(Object(o.c)("img","tech-icon")).src=`src/img/${e.icon_url}`});let g=Object(o.c)("div","description");if(g.innerHTML=n.description,h<900?(j.appendChild(m),j.appendChild(g)):(j.appendChild(g),j.appendChild(m)),j.appendChild(Object(o.c)("div","link-modal-icons")).innerHTML=`<div><a href=${n.site_url} target='_blank'><i class="fas fa-home fa-fw"></i></a>\n    <p class='home-tool-tip'>website</p></div>\n\n    <div><a href=${n.github_url} target='_blank'><i class="fab fa-github"></i></a>\n    <p class='github-tool-tip'>github</p></div>`,b[a].addEventListener("click",async()=>{if("true"===u)u="false",f[a].classList.add("close-curtain"),f[a].classList.remove("open-curtain"),b[a].lastChild.remove(),b[a].style.width="80%",b[a].style.padding="6%",b[a].style.margin="0",i.style.margin="0 10% 3% 10%",f[a].style.width="100%",i.classList.remove("project-wrap-click"),r.lastChild.remove();else if("false"===u){console.log(u),u="true",f[a].classList.add("open-curtain"),f[a].classList.remove("close-curtain"),b[a].appendChild(j),h<900?(b[a].style.flexDirection="column",j.style.width="90%",m.style.width="80%",j.style.marginTop="5%",j.style.background="rgb(240, 253, 253)"):(b[a].style.width="90%",b[a].style.padding="2%",b[a].style.margin="0 auto",i.style.margin="0 1%",f[a].style.width="99%",f[a].style.height="99%"),h<900?(console.log("900-"),r.appendChild(m)):(console.log("900+"),f[a].appendChild(m)),console.log(r),b[a].style.setProperty("--animation","animate-img-wrapper 1.5s linear forwards"),i.classList.add("project-wrap-click")}}),t&&t.isAdmin){const e=Object(o.c)("div","edit-project-wrapper"),t=Object(l.a)("show-edit-button","submit","update");t.addEventListener("click",()=>{console.log(i.lastChild.className),"edit-project-form"!==i.lastChild.className?Object(d.EditProject)(i,n):i.lastChild.remove()}),e.appendChild(t);const a=Object(l.a)("delete-project","submit","delete");a.addEventListener("click",async()=>{let e=confirm(`Are you sure you want to delete ${n.name}?`);e&&await Object(s.b)(n.id),e&&await p()}),e.appendChild(a),i.appendChild(e)}}),t&&t.isAdmin){let t=Object(l.a)("show-add-form","submit","add project");t.addEventListener("click",()=>{console.log(e.lastChild.previousSibling.className),"show-add-form"===e.lastChild.previousSibling.className?Object(d.EditProject)(e,n[0],"addProject"):e.lastChild.remove()}),Object(o.b)(e,t)}e.appendChild(Object(i.a)())}},103:function(e,t,n){"use strict";n.r(t),n.d(t,"EditProject",(function(){return l}));var o=n(3),a=n(96),c=n(97),i=n(100),s=n(0);const l=async(e,t,n)=>{if(console.log("add",n),"addProject"===n)for(let e in t)t[e]="";let l={},d=e=>{console.log(e.target.name,e.target.value),l[e.target.name]=e.target.value,console.log("cmon",l)},r=Object(o.c)("edit-project-form"),p=Object(s.c)("div","edit-form-inputs");r.appendChild(p),Object.keys(t).forEach(e=>{if("id"!==e&&"technologies"!==e&&"created_at"!==e&&"updated_at"!==e){l[e]=t[e];const a=Object(o.d)({className:"edit-form-input",name:e,type:"text",value:"addProject"===n?"":l[e],placeholder:e,handleChange:d});p.appendChild(a)}});const h=Object(s.c)("div","edit-form-checkboxes");r.appendChild(h),(await Object(a.a)()).map(e=>{let a;void 0===n&&t.technologies.forEach(t=>{e.name===t.name&&(console.log(e.name,t.name),a="checked")});let c=Object(o.b)({className:"edit-project-chkbox",name:e.name,id:e.name,value:e.id,checked:"addProject"===n?"":a});h.appendChild(c),h.appendChild(Object(o.e)("tech-box-label",e.name,"tech-box"))}),r.appendChild(Object(o.a)("edit-project-button","submit","addProject"===n?"add new project":"submit")),Object(s.b)(e,r),r.addEventListener("submit",async e=>{e.preventDefault(),console.log("add",n);const o=document.querySelectorAll("input[type=checkbox]:checked");console.log(o,l),l.technologies=[],o.forEach(e=>{l.technologies.push(e.value)}),console.log("add",l),"addProject"===n?await Object(c.a)(l):await Object(c.d)(l,t.id),await Object(i.Projects)()})}},104:function(e,t,n){var o=n(1),a=n(105);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var c={insert:"head",singleton:!1},i=(o(a,c),a.locals?a.locals:{});e.exports=i},105:function(e,t,n){},93:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const o=()=>"https://portfolio-mick-server.herokuapp.com"},94:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l}));var o=n(93);const a=Object(o.a)();const c=async e=>(console.log(JSON.stringify(e)),await fetch(a+"/users",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>(localStorage.setItem("authToken",e.token),e))),i=async e=>{console.log(e);let t=await fetch(a+"/auth/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>(localStorage.setItem("authToken",e.token),e));return console.log(t),t},s=async()=>{if(localStorage.getItem("authToken")){return await fetch(a+"/auth/verify",{method:"get",headers:(e={"Content-Type":"application/json"},localStorage.authToken?{...e,Authorization:`Bearer ${localStorage.authToken}`}:e)}).then(e=>e.json()).then(e=>e)}var e;return!1},l=async()=>(localStorage.removeItem("authToken"),{"Content-Type":"application/json"},"logged out")},96:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return i}));var o=n(93);const a=Object(o.a)();let c=async()=>await fetch(`${a}/technologies`).then(e=>e.json()).then(e=>e);const i=async(e,t)=>{await fetch(`${a}/technologies/${t}`,{method:"put",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>e)}},97:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l}));var o=n(93);const a=Object(o.a)();let c=async()=>await fetch(`${a}/projects`).then(e=>e.json()).then(e=>e);const i=async e=>{const t=await fetch(`${a}/projects`,{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>e);console.log(t)},s=async(e,t)=>{await fetch(`${a}/projects/${t}`,{method:"put",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>e)},l=async e=>{const t=await fetch(`${a}/projects/${e}`,{method:"delete",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>e);console.log(t)}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvQ29tcG9uZW50cy9Qcm9qZWN0cy9Qcm9qZWN0cy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvQ29tcG9uZW50cy9Qcm9qZWN0cy9FZGl0UHJvamVjdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvQ29tcG9uZW50cy9Qcm9qZWN0cy9wcm9qZWN0cy5zY3NzIiwid2VicGFjazovLy8uL3NyYy9Db21wb25lbnRzL1NlcnZpY2VzL0Jhc2VVcmwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0NvbXBvbmVudHMvU2VydmljZXMvQXBpQXV0aC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvQ29tcG9uZW50cy9TZXJ2aWNlcy9BcGlUZWNoLmpzIiwid2VicGFjazovLy8uL3NyYy9Db21wb25lbnRzL1NlcnZpY2VzL0FwaVByb2plY3QuanMiXSwibmFtZXMiOlsiY2xlYXJQYWdlIiwiZWxlbWVudCIsImNoaWxkTm9kZXMiLCJsZW5ndGgiLCJyZW1vdmVDaGlsZCIsImxhc3RDaGlsZCIsImFzeW5jIiwiUHJvamVjdHMiLCJtYWluQ29udGVudCIsImFwcGVuZENoaWxkIiwiaW5uZXJIVE1MIiwidXNlciIsInJlc3AiLCJjb250YWluZXJXaWR0aCIsImNsaWVudFdpZHRoIiwiZm9yRWFjaCIsInByb2plY3QiLCJpbmRleCIsInByb2plY3RXcmFwIiwiaW1hZ2UiLCJpbWdfdXJsIiwibmFtZSIsInNpdGVfdXJsIiwiYnVpbGRfZGF0ZSIsImJvb2wiLCJsaW5rTW9kYWwiLCJpbWdXcmFwcGVyIiwiaW5uZXJJbWdXcmFwIiwidGVjaEljb25zIiwidGVjaG5vbG9naWVzIiwiaWNvbiIsInNyYyIsImljb25fdXJsIiwiZGVzY3JpcHRpb24iLCJnaXRodWJfdXJsIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInN0eWxlIiwid2lkdGgiLCJwYWRkaW5nIiwibWFyZ2luIiwiY29uc29sZSIsImxvZyIsImZsZXhEaXJlY3Rpb24iLCJtYXJnaW5Ub3AiLCJiYWNrZ3JvdW5kIiwiaGVpZ2h0Iiwic2V0UHJvcGVydHkiLCJpc0FkbWluIiwiZWRpdFByb2plY3RXcmFwcGVyIiwiZWRpdEJ1dHRvbiIsImNsYXNzTmFtZSIsImRlbGV0ZUJ1dHRvbiIsImFuc3dlciIsImNvbmZpcm0iLCJpZCIsImFkZEJ0biIsInByZXZpb3VzU2libGluZyIsIkVkaXRQcm9qZWN0IiwiYWRkUHJvamVjdCIsIml0ZW0iLCJuZXdQcm9qZWN0IiwiaGFuZGxlQ2hhbmdlIiwiZSIsInRhcmdldCIsInZhbHVlIiwiZm9ybSIsImlucHV0cyIsIk9iamVjdCIsImtleXMiLCJrZXkiLCJpbnB1dCIsInR5cGUiLCJwbGFjZWhvbGRlciIsImNoZWNrcyIsIm1hcCIsInRlY2hub2xvZ3kiLCJjaGVja2VkIiwidW5kZWZpbmVkIiwicHJvamVjdFRlY2hub2xvZ3kiLCJieCIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiY2hlY2tib3hlcyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImJveCIsInB1c2giLCJhcGkiLCJjb250ZW50IiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJtb2R1bGUiLCJpIiwib3B0aW9ucyIsImV4cG9ydGVkIiwibG9jYWxzIiwiZXhwb3J0cyIsIkJhc2VVcmwiLCJiYXNlVXJsIiwic2lnblVwIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJ0aGVuIiwianNvbiIsImRhdGEiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwidG9rZW4iLCJsb2dpbiIsInJlcyIsInZlcmlmeSIsImdldEl0ZW0iLCJhdXRoVG9rZW4iLCJBdXRob3JpemF0aW9uIiwibG9nb3V0IiwicmVtb3ZlSXRlbSIsImdldFRlY2hub2xvZ2llcyIsImFucyIsInVwZGF0ZVRlY2hub2xvZ3kiLCJnZXRQcm9qZWN0cyIsInVwZGF0ZVByb2plY3QiLCJkZWxldGVQcm9qZWN0Il0sIm1hcHBpbmdzIjoiMEZBQUEsaUhBaUJBLE1B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LEdBQ0VBLEdBRVhwRSxRQUFRQyxJQUFJd0UsSUFJRFcsRUFBZ0J6SCxNQUFPaUcsRUFBTTlDLFdBRXRCaUQsTUFBTSxHQUFHTCxjQUFvQjVDLElBQU0sQ0FDbkRrRCxPQUFRLE1BQ1JKLEtBQU1DLEtBQUtDLFVBQVVGLEdBQ3JCSyxRQUFTLENBQUUsZUFBZ0Isc0JBRTFCQyxLQUFNQyxHQUNFQSxFQUFLQSxRQUViRCxLQUFNRSxHQUNFQSxJQUtBaUIsRUFBZ0IxSCxNQUFPbUQsSUFJbEMsTUFBTTJELFFBQVlWLE1BQU0sR0FBR0wsY0FBb0I1QyxJQUFNLENBQ25Ea0QsT0FBUSxTQUNSQyxRQUFTLENBQUUsZUFBZ0Isc0JBRTFCQyxLQUFNQyxHQUNFQSxFQUFLQSxRQUViRCxLQUFNRSxHQUNFQSxHQUVYcEUsUUFBUUMsSUFBSXdFIiwiZmlsZSI6IjEuOTcwMDZiNmMwMWMyMGM3ZDgzNzguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgXCIuLi9TaGFyZWQvSW1hZ2VcIlxuaW1wb3J0IHsgcXMsIHFzYSwgY2VjbCwgYWMsIGJ0biB9IGZyb20gXCIuLi9IZWxwZXJzL2RvbUhlbHBlclwiXG5pbXBvcnQgeyB2ZXJpZnkgfSBmcm9tIFwiLi4vU2VydmljZXMvQXBpQXV0aC5qc1wiXG5pbXBvcnQgeyBJbWFnZSB9IGZyb20gXCIuLi9TaGFyZWQvSW1hZ2UuanNcIlxuaW1wb3J0IHsgRm9vdGVyIH0gZnJvbSBcIi4uL0Zvb3Rlci9Gb290ZXIuanNcIlxuaW1wb3J0IHtcbiAgZ2V0UHJvamVjdHMsXG4gIGRlbGV0ZVByb2plY3QsXG5cbn0gZnJvbSBcIi4uL1NlcnZpY2VzL0FwaVByb2plY3QuanNcIlxuaW1wb3J0IHsgRm9ybSwgSW5wdXQsIEJ1dHRvbiwgQ2hlY2tib3gsIExhYmVsIH0gZnJvbSBcIi4uL1NoYXJlZC9Gb3JtLmpzXCJcbmltcG9ydCB7IEVkaXRQcm9qZWN0IH0gZnJvbSBcIi4vRWRpdFByb2plY3RcIlxuaW1wb3J0IFwiLi9wcm9qZWN0cy5zY3NzXCJcblxuLyoqKioqKioqKipcbiBDTEVBUiBQQUdFXG4qKioqKioqKioqKi9cbmNvbnN0IGNsZWFyUGFnZSA9IChlbGVtZW50KSA9PiB7XG4gIHdoaWxlIChlbGVtZW50LmNoaWxkTm9kZXMubGVuZ3RoKSB7XG4gICAgZWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50Lmxhc3RDaGlsZClcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUHJvamVjdHMoKSB7XG5cbiAgY29uc3QgbWFpbkNvbnRlbnQgPSBxcygnLnNjcm9sbGFibGUtY29udGVudCcpXG4gIGNsZWFyUGFnZShtYWluQ29udGVudClcbiAgbGV0IGxvYWRpbmcgPSBtYWluQ29udGVudC5hcHBlbmRDaGlsZChjZWNsKFwiZGl2XCIsIFwibG9hZGluZ1wiKSlcbiAgbG9hZGluZy5pbm5lckhUTUwgPSBcImxvYWRpbmcuLi5cIlxuICBjb25zdCB1c2VyID0gYXdhaXQgdmVyaWZ5KClcblxuXG4gIC8qKioqKioqKioqKioqKlxuICBSRU5ERVIgUFJPSkVDVFNcbiAgKioqKioqKioqKioqKioqL1xuICBjb25zdCByZXNwID0gYXdhaXQgZ2V0UHJvamVjdHMoKVxuICBjbGVhclBhZ2UobWFpbkNvbnRlbnQpXG5cbiAgY29uc3QgY29udGFpbmVyV2lkdGggPSBtYWluQ29udGVudC5jbGllbnRXaWR0aFxuICByZXNwLmZvckVhY2goYXN5bmMgKHByb2plY3QsIGluZGV4KSA9PiB7XG5cbiAgICBjb25zdCBwcm9qZWN0V3JhcCA9IG1haW5Db250ZW50LmFwcGVuZENoaWxkKGNlY2woXCJkaXZcIiwgXCJwcm9qZWN0LXdyYXBcIikpXG4gICAgY29uc3QgaW1hZ2UgPSBwcm9qZWN0V3JhcC5hcHBlbmRDaGlsZChcbiAgICAgIEltYWdlKGBzcmMvaW1nLyR7cHJvamVjdC5pbWdfdXJsfWAsIHByb2plY3QubmFtZSwgdHJ1ZSwgcHJvamVjdC5zaXRlX3VybCwgcHJvamVjdC5idWlsZF9kYXRlKVxuICAgIClcbiAgIFxuICAgIGxldCBib29sID0gXCJmYWxzZVwiXG4gICAgbGV0IGxpbmtNb2RhbCA9IGNlY2woXCJkaXZcIiwgXCJsaW5rLW1vZGFsXCIpXG4gICAgbGV0IGltZ1dyYXBwZXIgPSBxc2EoXCIuaW1nLXdyYXBwZXJcIilcbiAgICBsZXQgaW5uZXJJbWdXcmFwID0gcXNhKFwiLmlubmVyLWltZy13cmFwXCIpXG4gICAgbGV0IHRlY2hJY29ucyA9IGNlY2woXCJkaXZcIiwgXCJ0ZWNoLWljb25zXCIpXG4gICAgcHJvamVjdC50ZWNobm9sb2dpZXMuZm9yRWFjaCgoaWNvbikgPT4ge1xuICAgICAgbGV0IHRlY2hJY29uID0gdGVjaEljb25zLmFwcGVuZENoaWxkKGNlY2woXCJpbWdcIiwgXCJ0ZWNoLWljb25cIikpXG4gICAgICB0ZWNoSWNvbi5zcmMgPSBgc3JjL2ltZy8ke2ljb24uaWNvbl91cmx9YFxuICAgIH0pXG4gICAgbGV0IGRlc2NyaXB0aW9uID0gY2VjbCgnZGl2JywgJ2Rlc2NyaXB0aW9uJylcbiAgICBkZXNjcmlwdGlvbi5pbm5lckhUTUwgPSBwcm9qZWN0LmRlc2NyaXB0aW9uXG5cbiAgICBpZiAoY29udGFpbmVyV2lkdGggPCA5MDApIHtcbiAgICAgIGxpbmtNb2RhbC5hcHBlbmRDaGlsZCh0ZWNoSWNvbnMpXG4gICAgICBsaW5rTW9kYWwuYXBwZW5kQ2hpbGQoZGVzY3JpcHRpb24pXG4gICAgfSBlbHNlIHtcbiAgICAgIGxpbmtNb2RhbC5hcHBlbmRDaGlsZChkZXNjcmlwdGlvbilcbiAgICAgIGxpbmtNb2RhbC5hcHBlbmRDaGlsZCh0ZWNoSWNvbnMpXG4gICAgfVxuXG4gICAgY29uc3QgbGlua01vZGFsSWNvbnMgPSBsaW5rTW9kYWwuYXBwZW5kQ2hpbGQoY2VjbCgnZGl2JywgJ2xpbmstbW9kYWwtaWNvbnMnKSlcblxuICAgIGxpbmtNb2RhbEljb25zLmlubmVySFRNTCA9XG4gICAgICBgPGRpdj48YSBocmVmPSR7cHJvamVjdC5zaXRlX3VybH0gdGFyZ2V0PSdfYmxhbmsnPjxpIGNsYXNzPVwiZmFzIGZhLWhvbWUgZmEtZndcIj48L2k+PC9hPlxuICAgIDxwIGNsYXNzPSdob21lLXRvb2wtdGlwJz53ZWJzaXRlPC9wPjwvZGl2PlxuXG4gICAgPGRpdj48YSBocmVmPSR7cHJvamVjdC5naXRodWJfdXJsfSB0YXJnZXQ9J19ibGFuayc+PGkgY2xhc3M9XCJmYWIgZmEtZ2l0aHViXCI+PC9pPjwvYT5cbiAgICA8cCBjbGFzcz0nZ2l0aHViLXRvb2wtdGlwJz5naXRodWI8L3A+PC9kaXY+YFxuXG5cbiAgICAvKioqKioqKioqKioqKipcbiAgICBBREQgTElOSyBNT0RBTFxuICAgICoqKioqKioqKioqKioqKi9cbiAgICBpbWdXcmFwcGVyW2luZGV4XS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKGJvb2wgPT09IFwidHJ1ZVwiKSB7XG4gICAgICAgIGJvb2wgPSBcImZhbHNlXCJcbiAgICAgICAgaW5uZXJJbWdXcmFwW2luZGV4XS5jbGFzc0xpc3QuYWRkKFwiY2xvc2UtY3VydGFpblwiKVxuICAgICAgICBpbm5lckltZ1dyYXBbaW5kZXhdLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuLWN1cnRhaW5cIilcbiAgICAgICAgaW1nV3JhcHBlcltpbmRleF0ubGFzdENoaWxkLnJlbW92ZSgpXG5cblxuICAgICAgICBpbWdXcmFwcGVyW2luZGV4XS5zdHlsZS53aWR0aCA9ICc4MCUnXG4gICAgICAgIGltZ1dyYXBwZXJbaW5kZXhdLnN0eWxlLnBhZGRpbmcgPSAnNiUnXG4gICAgICAgIGltZ1dyYXBwZXJbaW5kZXhdLnN0eWxlLm1hcmdpbiA9ICcwJ1xuXG4gICAgICAgIHByb2plY3RXcmFwLnN0eWxlLm1hcmdpbiA9ICcwIDEwJSAzJSAxMCUnXG4gICAgICAgIGlubmVySW1nV3JhcFtpbmRleF0uc3R5bGUud2lkdGggPSAnMTAwJSdcblxuICAgICAgICBwcm9qZWN0V3JhcC5jbGFzc0xpc3QucmVtb3ZlKFwicHJvamVjdC13cmFwLWNsaWNrXCIpXG5cbiAgICAgICAgaW1hZ2UubGFzdENoaWxkLnJlbW92ZSgpXG5cbiAgICAgICAgLy8gaW5uZXJJbWdXcmFwW2luZGV4XS5zdHlsZS5oZWlnaHQgPSAnMTAwJSdcblxuICAgICAgfSBlbHNlIGlmIChib29sID09PSBcImZhbHNlXCIpIHtcbiAgICAgICAgY29uc29sZS5sb2coYm9vbClcbiAgICAgICAgYm9vbCA9IFwidHJ1ZVwiXG4gICAgICAgIGlubmVySW1nV3JhcFtpbmRleF0uY2xhc3NMaXN0LmFkZChcIm9wZW4tY3VydGFpblwiKVxuICAgICAgICBpbm5lckltZ1dyYXBbaW5kZXhdLmNsYXNzTGlzdC5yZW1vdmUoXCJjbG9zZS1jdXJ0YWluXCIpXG4gICAgICAgIGltZ1dyYXBwZXJbaW5kZXhdLmFwcGVuZENoaWxkKGxpbmtNb2RhbClcblxuXG4gICAgICAgIGlmIChjb250YWluZXJXaWR0aCA8IDkwMCkge1xuICAgICAgICAgIGltZ1dyYXBwZXJbaW5kZXhdLnN0eWxlLmZsZXhEaXJlY3Rpb24gPSAnY29sdW1uJ1xuICAgICAgICAgIGxpbmtNb2RhbC5zdHlsZS53aWR0aCA9ICc5MCUnXG4gICAgICAgICAgdGVjaEljb25zLnN0eWxlLndpZHRoID0gJzgwJSdcbiAgICAgICAgICBsaW5rTW9kYWwuc3R5bGUubWFyZ2luVG9wID0gJzUlJ1xuICAgICAgICAgIGxpbmtNb2RhbC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JnYigyNDAsIDI1MywgMjUzKSdcbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgIGltZ1dyYXBwZXJbaW5kZXhdLnN0eWxlLndpZHRoID0gJzkwJSdcbiAgICAgICAgICBpbWdXcmFwcGVyW2luZGV4XS5zdHlsZS5wYWRkaW5nID0gJzIlJ1xuICAgICAgICAgIGltZ1dyYXBwZXJbaW5kZXhdLnN0eWxlLm1hcmdpbiA9ICcwIGF1dG8nXG4gICAgICAgICAgcHJvamVjdFdyYXAuc3R5bGUubWFyZ2luID0gJzAgMSUnXG5cbiAgICAgICAgICBpbm5lckltZ1dyYXBbaW5kZXhdLnN0eWxlLndpZHRoID0gJzk5JSdcbiAgICAgICAgICBpbm5lckltZ1dyYXBbaW5kZXhdLnN0eWxlLmhlaWdodCA9ICc5OSUnXG4gICAgICAgICAgLy8gXG4gICAgICAgIH1cblxuXG4gICAgICAgIGlmIChjb250YWluZXJXaWR0aCA8IDkwMCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCc5MDAtJylcbiAgICAgICAgICBpbWFnZS5hcHBlbmRDaGlsZCh0ZWNoSWNvbnMpXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJzkwMCsnKVxuICAgICAgICAgIGlubmVySW1nV3JhcFtpbmRleF0uYXBwZW5kQ2hpbGQodGVjaEljb25zKVxuXG4gICAgICAgIH1cblxuXG5cbiAgICAgICAgY29uc29sZS5sb2coaW1hZ2UpXG5cbiAgICAgICAgbGV0IGl3ID0gaW1nV3JhcHBlcltpbmRleF0uc3R5bGVcbiAgICAgICAgaXcuc2V0UHJvcGVydHkoXG4gICAgICAgICAgXCItLWFuaW1hdGlvblwiLFxuICAgICAgICAgIFwiYW5pbWF0ZS1pbWctd3JhcHBlciAxLjVzIGxpbmVhciBmb3J3YXJkc1wiXG4gICAgICAgIClcbiAgICAgICAgcHJvamVjdFdyYXAuY2xhc3NMaXN0LmFkZChcInByb2plY3Qtd3JhcC1jbGlja1wiKVxuXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8qKioqKioqKioqKioqKioqKioqXG4gICAgIEVESVQgUFJPSkVDVCBCVVRUT05cbiAgICAqKioqKioqKioqKioqKioqKioqKi9cbiAgIFxuICAgIGlmICh1c2VyICYmIHVzZXIuaXNBZG1pbikge1xuXG4gICAgICBjb25zdCBlZGl0UHJvamVjdFdyYXBwZXIgPSBjZWNsKFwiZGl2XCIsIFwiZWRpdC1wcm9qZWN0LXdyYXBwZXJcIilcbiAgICAgIGNvbnN0IGVkaXRCdXR0b24gPSBCdXR0b24oXCJzaG93LWVkaXQtYnV0dG9uXCIsIFwic3VibWl0XCIsIFwidXBkYXRlXCIpXG4gICAgICBlZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKHByb2plY3RXcmFwLmxhc3RDaGlsZC5jbGFzc05hbWUpXG4gICAgICAgIGlmIChcbiAgICAgICAgICBwcm9qZWN0V3JhcC5sYXN0Q2hpbGQuY2xhc3NOYW1lICE9PSBcImVkaXQtcHJvamVjdC1mb3JtXCJcbiAgICAgICAgKVxuICAgICAgICAgIEVkaXRQcm9qZWN0KHByb2plY3RXcmFwLCBwcm9qZWN0KVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBwcm9qZWN0V3JhcC5sYXN0Q2hpbGQucmVtb3ZlKClcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIGVkaXRQcm9qZWN0V3JhcHBlci5hcHBlbmRDaGlsZChlZGl0QnV0dG9uKVxuXG4gICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgREVMRVRFIFBST0pFQ1QgQlVUVE9OXG4gICAgICAqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICBjb25zdCBkZWxldGVCdXR0b24gPSBCdXR0b24oXCJkZWxldGUtcHJvamVjdFwiLCBcInN1Ym1pdFwiLCBcImRlbGV0ZVwiKVxuICAgICAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGxldCBhbnN3ZXIgPSBjb25maXJtKGBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlICR7cHJvamVjdC5uYW1lfT9gKVxuICAgICAgICBhbnN3ZXIgJiYgYXdhaXQgZGVsZXRlUHJvamVjdChwcm9qZWN0LmlkKVxuICAgICAgICBhbnN3ZXIgJiYgYXdhaXQgUHJvamVjdHMoKVxuICAgICAgfSlcbiAgICAgIGVkaXRQcm9qZWN0V3JhcHBlci5hcHBlbmRDaGlsZChkZWxldGVCdXR0b24pXG4gICAgICBwcm9qZWN0V3JhcC5hcHBlbmRDaGlsZChlZGl0UHJvamVjdFdyYXBwZXIpXG4gICAgfVxuICB9KVxuXG4gIC8qKioqKioqKioqKlxuICBBREQgUFJPSkVDVCBcbiAgKioqKioqKioqKioqL1xuICBpZiAodXNlciAmJiB1c2VyLmlzQWRtaW4pIHtcblxuICAgIGxldCBhZGRCdG4gPSBCdXR0b24oXCJzaG93LWFkZC1mb3JtXCIsIFwic3VibWl0XCIsIFwiYWRkIHByb2plY3RcIilcbiAgICBhZGRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKG1haW5Db250ZW50Lmxhc3RDaGlsZC5wcmV2aW91c1NpYmxpbmcuY2xhc3NOYW1lKVxuICAgICAgaWYgKG1haW5Db250ZW50Lmxhc3RDaGlsZC5wcmV2aW91c1NpYmxpbmcuY2xhc3NOYW1lID09PSBcInNob3ctYWRkLWZvcm1cIilcbiAgICAgICAgRWRpdFByb2plY3QobWFpbkNvbnRlbnQsIHJlc3BbMF0sIFwiYWRkUHJvamVjdFwiKVxuICAgICAgZWxzZSB7XG4gICAgICAgIG1haW5Db250ZW50Lmxhc3RDaGlsZC5yZW1vdmUoKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBhYyhtYWluQ29udGVudCwgYWRkQnRuKVxuICB9XG5cbiAgbWFpbkNvbnRlbnQuYXBwZW5kQ2hpbGQoRm9vdGVyKCkpXG5cblxufVxuIiwiaW1wb3J0IHsgRm9ybSwgSW5wdXQsIEJ1dHRvbiwgQ2hlY2tib3gsIExhYmVsIH0gZnJvbSBcIi4uL1NoYXJlZC9Gb3JtLmpzXCJcbmltcG9ydCB7IGdldFRlY2hub2xvZ2llcyB9IGZyb20gXCIuLi9TZXJ2aWNlcy9BcGlUZWNoLmpzXCJcbmltcG9ydCB7XG4gIGdldFByb2plY3QsXG4gIGFkZFByb2plY3QgYXMgYWRkTmV3UHJvamVjdCxcbiAgdXBkYXRlUHJvamVjdCxcbiAgZGVsZXRlUHJvamVjdCxcbiAgdXBkYXRlUHJvamVjdFRlY2hub2xvZ2llcyxcbn0gZnJvbSBcIi4uL1NlcnZpY2VzL0FwaVByb2plY3QuanNcIlxuaW1wb3J0IHsgUHJvamVjdHMgfSBmcm9tIFwiLi9Qcm9qZWN0cy5qc1wiXG5pbXBvcnQgeyBhYywgY2VjbCB9IGZyb20gXCIuLi9IZWxwZXJzL2RvbUhlbHBlci5qc1wiXG5cbmV4cG9ydCBjb25zdCBFZGl0UHJvamVjdCA9IGFzeW5jIChwcm9qZWN0V3JhcCwgcHJvamVjdCwgYWRkUHJvamVjdCkgPT4ge1xuICAvKioqKioqKioqKioqKioqKioqKioqKioqXG4gIE1BS0UgQU5EIFNFVCBGT1JNICBJTlBVVFNcbiAgKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgY29uc29sZS5sb2coXCJhZGRcIiwgYWRkUHJvamVjdClcbiAgaWYgKGFkZFByb2plY3QgPT09IFwiYWRkUHJvamVjdFwiKSB7XG4gICAgZm9yIChsZXQgaXRlbSBpbiBwcm9qZWN0KSB7XG4gICAgICBwcm9qZWN0W2l0ZW1dID0gXCJcIlxuICAgIH1cbiAgfVxuICBsZXQgbmV3UHJvamVjdCA9IHt9XG5cbiAgbGV0IGhhbmRsZUNoYW5nZSA9IChlKSA9PiB7XG4gICAgY29uc29sZS5sb2coZS50YXJnZXQubmFtZSwgZS50YXJnZXQudmFsdWUpXG4gICAgbmV3UHJvamVjdFtlLnRhcmdldC5uYW1lXSA9IGUudGFyZ2V0LnZhbHVlXG4gICAgY29uc29sZS5sb2coJ2Ntb24nLCBuZXdQcm9qZWN0KVxuICB9XG5cbiAgbGV0IGZvcm0gPSBGb3JtKFwiZWRpdC1wcm9qZWN0LWZvcm1cIilcbiAgbGV0IGlucHV0cyA9IGNlY2woJ2RpdicsICdlZGl0LWZvcm0taW5wdXRzJylcbiAgZm9ybS5hcHBlbmRDaGlsZChpbnB1dHMpXG4gIE9iamVjdC5rZXlzKHByb2plY3QpLmZvckVhY2goKGtleSkgPT4ge1xuICAgIGlmIChcbiAgICAgIGtleSAhPT0gXCJpZFwiICYmXG4gICAgICBrZXkgIT09IFwidGVjaG5vbG9naWVzXCIgJiZcbiAgICAgIGtleSAhPT0gXCJjcmVhdGVkX2F0XCIgJiZcbiAgICAgIGtleSAhPT0gXCJ1cGRhdGVkX2F0XCJcbiAgICApIHtcbiAgICAgIG5ld1Byb2plY3Rba2V5XSA9IHByb2plY3Rba2V5XVxuICAgICAgY29uc3QgaW5wdXQgPSBJbnB1dCh7XG4gICAgICAgIGNsYXNzTmFtZTogXCJlZGl0LWZvcm0taW5wdXRcIixcbiAgICAgICAgbmFtZToga2V5LFxuICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgdmFsdWU6IGFkZFByb2plY3QgPT09IFwiYWRkUHJvamVjdFwiID8gXCJcIiA6IG5ld1Byb2plY3Rba2V5XSxcbiAgICAgICAgcGxhY2Vob2xkZXI6IGtleSxcbiAgICAgICAgaGFuZGxlQ2hhbmdlOiBoYW5kbGVDaGFuZ2UsXG4gICAgICB9KVxuICAgICAgaW5wdXRzLmFwcGVuZENoaWxkKGlucHV0KVxuICAgIH1cbiAgfSlcblxuICAvKioqKioqKioqKioqKipcbiAgIFNFVCBDSEVDS0JPWEVTXG4gICoqKioqKioqKioqKioqKi9cbiAgY29uc3QgY2hlY2tzID0gY2VjbCgnZGl2JywgJ2VkaXQtZm9ybS1jaGVja2JveGVzJylcbiAgZm9ybS5hcHBlbmRDaGlsZChjaGVja3MpXG4gIGxldCB0ZWNobm9sb2dpZXMgPSBhd2FpdCBnZXRUZWNobm9sb2dpZXMoKVxuICB0ZWNobm9sb2dpZXMubWFwKCh0ZWNobm9sb2d5KSA9PiB7XG5cbiAgICBsZXQgY2hlY2tlZFxuICAgIGFkZFByb2plY3QgPT09IHVuZGVmaW5lZCAmJlxuICAgICAgcHJvamVjdC50ZWNobm9sb2dpZXMuZm9yRWFjaCgocHJvamVjdFRlY2hub2xvZ3kpID0+IHtcbiAgICAgICAgaWYgKHRlY2hub2xvZ3kubmFtZSA9PT0gcHJvamVjdFRlY2hub2xvZ3kubmFtZSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKHRlY2hub2xvZ3kubmFtZSwgcHJvamVjdFRlY2hub2xvZ3kubmFtZSlcbiAgICAgICAgICBjaGVja2VkID0gXCJjaGVja2VkXCJcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICBsZXQgYnggPSBDaGVja2JveCh7XG4gICAgICBjbGFzc05hbWU6IFwiZWRpdC1wcm9qZWN0LWNoa2JveFwiLFxuICAgICAgbmFtZTogdGVjaG5vbG9neS5uYW1lLFxuICAgICAgaWQ6IHRlY2hub2xvZ3kubmFtZSxcbiAgICAgIHZhbHVlOiB0ZWNobm9sb2d5LmlkLFxuICAgICAgY2hlY2tlZDogYWRkUHJvamVjdCA9PT0gXCJhZGRQcm9qZWN0XCIgPyBcIlwiIDogY2hlY2tlZCxcblxuICAgIH0pXG4gICAgY2hlY2tzLmFwcGVuZENoaWxkKGJ4KVxuICAgIGNoZWNrcy5hcHBlbmRDaGlsZChMYWJlbChcInRlY2gtYm94LWxhYmVsXCIsIHRlY2hub2xvZ3kubmFtZSwgXCJ0ZWNoLWJveFwiKSlcblxuICB9KVxuICBmb3JtLmFwcGVuZENoaWxkKFxuICAgIEJ1dHRvbihcbiAgICAgIFwiZWRpdC1wcm9qZWN0LWJ1dHRvblwiLFxuICAgICAgXCJzdWJtaXRcIixcbiAgICAgIGFkZFByb2plY3QgPT09IFwiYWRkUHJvamVjdFwiID8gXCJhZGQgbmV3IHByb2plY3RcIiA6IFwic3VibWl0XCJcbiAgICApXG4gIClcblxuXG4gIGFjKHByb2plY3RXcmFwLCBmb3JtKVxuXG5cbiAgLyoqKioqKioqKipcbiAgIFNVQk1JVCBGT1JNXG4gICoqKioqKioqKioqL1xuICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgYXN5bmMgKGV2dCkgPT4ge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgY29uc29sZS5sb2coXCJhZGRcIiwgYWRkUHJvamVjdClcblxuICAgIGNvbnN0IGNoZWNrYm94ZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRbdHlwZT1jaGVja2JveF06Y2hlY2tlZFwiKVxuICAgIGNvbnNvbGUubG9nKGNoZWNrYm94ZXMsIG5ld1Byb2plY3QpXG4gICAgbmV3UHJvamVjdC50ZWNobm9sb2dpZXMgPSBbXVxuICAgIGNoZWNrYm94ZXMuZm9yRWFjaCgoYm94KSA9PiB7XG4gICAgICBuZXdQcm9qZWN0LnRlY2hub2xvZ2llcy5wdXNoKGJveC52YWx1ZSlcbiAgICB9KVxuICAgIGNvbnNvbGUubG9nKFwiYWRkXCIsIG5ld1Byb2plY3QpXG4gICAgYWRkUHJvamVjdCA9PT0gXCJhZGRQcm9qZWN0XCJcbiAgICAgID8gYXdhaXQgYWRkTmV3UHJvamVjdChuZXdQcm9qZWN0KVxuICAgICAgOiBhd2FpdCB1cGRhdGVQcm9qZWN0KG5ld1Byb2plY3QsIHByb2plY3QuaWQpXG5cbiAgICBhd2FpdCBQcm9qZWN0cygpXG4gIH0pXG59XG4iLCJ2YXIgYXBpID0gcmVxdWlyZShcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIik7XG4gICAgICAgICAgICB2YXIgY29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9taW5pLWNzcy1leHRyYWN0LXBsdWdpbi9kaXN0L2xvYWRlci5qcyEuLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcyEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvZGlzdC9janMuanMhLi9wcm9qZWN0cy5zY3NzXCIpO1xuXG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5fX2VzTW9kdWxlID8gY29udGVudC5kZWZhdWx0IDogY29udGVudDtcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG4gICAgICAgICAgICB9XG5cbnZhciBvcHRpb25zID0ge307XG5cbm9wdGlvbnMuaW5zZXJ0ID0gXCJoZWFkXCI7XG5vcHRpb25zLnNpbmdsZXRvbiA9IGZhbHNlO1xuXG52YXIgdXBkYXRlID0gYXBpKGNvbnRlbnQsIG9wdGlvbnMpO1xuXG52YXIgZXhwb3J0ZWQgPSBjb250ZW50LmxvY2FscyA/IGNvbnRlbnQubG9jYWxzIDoge307XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydGVkOyIsIlxuZXhwb3J0IGNvbnN0IEJhc2VVcmwgPSAoKSA9PiB7XG5cbiAgICByZXR1cm4gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdodHRwczovL3BvcnRmb2xpby1taWNrLXNlcnZlci5oZXJva3VhcHAuY29tJyA6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnXG5cbn0iLCJpbXBvcnQgeyBCYXNlVXJsIH0gZnJvbSBcIi4vQmFzZVVybC5qc1wiXG5jb25zdCBiYXNlVXJsID0gQmFzZVVybCgpXG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRIZWFkZXJzKGhlYWRlcnMpIHtcbiAgaWYgKGxvY2FsU3RvcmFnZS5hdXRoVG9rZW4pIHtcbiAgICByZXR1cm4ge1xuICAgICAgLi4uaGVhZGVycyxcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtsb2NhbFN0b3JhZ2UuYXV0aFRva2VufWAsXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBoZWFkZXJzXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGNsZWFySGVhZGVycyA9IChoZWFkZXJzKSA9PiB7XG4gIHJldHVybiB7XG4gICAgLi4uaGVhZGVycyxcbiAgICBBdXRob3JpemF0aW9uOiBudWxsLFxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBzaWduVXAgPSBhc3luYyAoYm9keSkgPT4ge1xuICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShib2R5KSlcblxuICBsZXQgcmVzID0gYXdhaXQgZmV0Y2goYmFzZVVybCArIFwiL3VzZXJzXCIsIHtcbiAgICBtZXRob2Q6IFwicG9zdFwiLFxuICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcbiAgfSlcbiAgICAudGhlbigoanNvbikgPT4ge1xuICAgICAgcmV0dXJuIGpzb24uanNvbigpXG4gICAgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImF1dGhUb2tlblwiLCBkYXRhLnRva2VuKVxuXG4gICAgICByZXR1cm4gZGF0YVxuICAgIH0pXG4gIHJldHVybiByZXNcbn1cblxuZXhwb3J0IGNvbnN0IGxvZ2luID0gYXN5bmMgKGJvZHkpID0+IHtcbiAgY29uc29sZS5sb2coYm9keSlcbiAgbGV0IHJlcyA9IGF3YWl0IGZldGNoKGJhc2VVcmwgKyBcIi9hdXRoL2xvZ2luXCIsIHtcbiAgICBtZXRob2Q6IFwicG9zdFwiLFxuICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcbiAgfSlcbiAgICAudGhlbigoanNvbikgPT4ge1xuICAgICAgcmV0dXJuIGpzb24uanNvbigpXG5cbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKVxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJhdXRoVG9rZW5cIiwgZGF0YS50b2tlbilcblxuXG4gICAgICByZXR1cm4gZGF0YVxuICAgIH0pXG4gIGNvbnNvbGUubG9nKHJlcylcbiAgcmV0dXJuIHJlc1xufVxuXG5leHBvcnQgY29uc3QgdmVyaWZ5ID0gYXN5bmMgKCkgPT4ge1xuICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYXV0aFRva2VuXCIpXG4gIC8vIGNvbnNvbGUubG9nKHRva2VuKVxuICBpZiAodG9rZW4pIHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChiYXNlVXJsICsgXCIvYXV0aC92ZXJpZnlcIiwge1xuICAgICAgbWV0aG9kOiBcImdldFwiLFxuICAgICAgaGVhZGVyczogc2V0SGVhZGVycyh7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSksXG4gICAgfSlcbiAgICAgIC50aGVuKChqc29uKSA9PiB7XG4gICAgICAgIHJldHVybiBqc29uLmpzb24oKVxuICAgICAgfSlcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgIHJldHVybiBkYXRhXG4gICAgICB9KVxuXG4gICAgcmV0dXJuIHJlc1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlXG59XG5cbmV4cG9ydCBjb25zdCBnZXRDdXJyZW50VXNlciA9IGFzeW5jICgpID0+IHtcbiAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYXV0aFRva2VuXCIpKSB7XG4gICAgLy8gY29uc29sZS5sb2coXCJoZXJlXCIsIGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYXV0aFRva2VuXCIpKVxuICAgIGxldCB1c2VyID0gYXdhaXQgdmVyaWZ5KClcbiAgICBjb25zb2xlLmxvZyh1c2VyKVxuICAgIGlmICghdXNlci5lcnJvcnMpIHtcbiAgICAgIC8vIGxvZ2luQnV0dG9uLmlubmVyVGV4dCA9IFwibG9nb3V0XCJcbiAgICAgIC8vIGxvZ2dlZEluID0gdHJ1ZVxuICAgICAgcmV0dXJuIHVzZXJcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gbG9naW5CdXR0b24uaW5uZXJUZXh0ID0gXCJsb2dpblwiXG5cbiAgICAvLyBsb2dnZWRJbiA9IGZhbHNlXG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbiAgY29uc29sZS5sb2cobG9nZ2VkSW4pXG59XG5cbmV4cG9ydCBjb25zdCBsb2dvdXQgPSBhc3luYyAoKSA9PiB7XG4gIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwiYXV0aFRva2VuXCIpXG4gIGNsZWFySGVhZGVycyh7XG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0pXG4gIHJldHVybiBcImxvZ2dlZCBvdXRcIlxufVxuIiwiaW1wb3J0IHsgQmFzZVVybCB9IGZyb20gJy4vQmFzZVVybC5qcydcbmNvbnN0IGJhc2VVcmwgPSBCYXNlVXJsKClcblxuXG5cblxuZXhwb3J0IGxldCBnZXRUZWNobm9sb2dpZXMgPSBhc3luYyAoKSA9PiB7XG4gIGxldCByZXN1bHRzID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vdGVjaG5vbG9naWVzYClcbiAgICAudGhlbigocmVzKSA9PiB7XG5cbiAgICAgIHJldHVybiByZXMuanNvbigpXG4gICAgfSlcbiAgICAudGhlbigoYW5zKSA9PiB7XG4gICAgICByZXR1cm4gYW5zXG4gICAgfSlcblxuICByZXR1cm4gcmVzdWx0c1xufVxuXG5leHBvcnQgY29uc3QgdXBkYXRlVGVjaG5vbG9neSA9IGFzeW5jIChib2R5LCBpZCkgPT4ge1xuICBcbiAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vdGVjaG5vbG9naWVzLyR7aWR9YCwge1xuICAgIG1ldGhvZDogYHB1dGAsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gIH0pXG4gICAgLnRoZW4oKGpzb24pID0+IHtcbiAgICAgIHJldHVybiBqc29uLmpzb24oKVxuICAgIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSlcblxufVxuXG4iLCJpbXBvcnQgeyBCYXNlVXJsIH0gZnJvbSAnLi9CYXNlVXJsLmpzJ1xuY29uc3QgYmFzZVVybCA9IEJhc2VVcmwoKVxuXG5cbmV4cG9ydCBsZXQgZ2V0UHJvamVjdHMgPSBhc3luYyAoKSA9PiB7XG4gIGxldCByZXN1bHRzID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vcHJvamVjdHNgKVxuICAgIC50aGVuKChyZXMpID0+IHtcblxuICAgICAgcmV0dXJuIHJlcy5qc29uKClcbiAgICB9KVxuICAgIC50aGVuKChhbnMpID0+IHtcbiAgICAgIHJldHVybiBhbnNcbiAgICB9KVxuXG4gIHJldHVybiByZXN1bHRzXG59XG5cbmV4cG9ydCBsZXQgZ2V0UHJvamVjdCA9IGFzeW5jIChpZCkgPT4ge1xuICBsZXQgcmVzdWx0ID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vcHJvamVjdHMvJHtpZH1gKVxuICAgIC50aGVuKChyZXMpID0+IHtcblxuICAgICAgcmV0dXJuIHJlcy5qc29uKClcbiAgICB9KVxuICAgIC50aGVuKChhbnMpID0+IHtcbiAgICAgIHJldHVybiBhbnNcbiAgICB9KVxuXG4gIHJldHVybiByZXN1bHRcbn1cblxuXG5cbmV4cG9ydCBjb25zdCBhZGRQcm9qZWN0ID0gYXN5bmMgKGJvZHkpID0+IHtcbiBcbiBcbiAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vcHJvamVjdHNgLCB7XG4gICAgbWV0aG9kOiBgcG9zdGAsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gIH0pXG4gICAgLnRoZW4oKGpzb24pID0+IHtcbiAgICAgIHJldHVybiBqc29uLmpzb24oKVxuICAgIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSlcbiAgY29uc29sZS5sb2cocmVzKVxufVxuXG5cbmV4cG9ydCBjb25zdCB1cGRhdGVQcm9qZWN0ID0gYXN5bmMgKGJvZHksIGlkKSA9PiB7XG4gIFxuICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9wcm9qZWN0cy8ke2lkfWAsIHtcbiAgICBtZXRob2Q6IGBwdXRgLFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICB9KVxuICAgIC50aGVuKChqc29uKSA9PiB7XG4gICAgICByZXR1cm4ganNvbi5qc29uKClcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICByZXR1cm4gZGF0YVxuICAgIH0pXG5cbn1cbi8vXG5leHBvcnQgY29uc3QgZGVsZXRlUHJvamVjdCA9IGFzeW5jIChpZCkgPT4ge1xuXG5cblxuICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9wcm9qZWN0cy8ke2lkfWAsIHtcbiAgICBtZXRob2Q6IGBkZWxldGVgLFxuICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XG4gIH0pXG4gICAgLnRoZW4oKGpzb24pID0+IHtcbiAgICAgIHJldHVybiBqc29uLmpzb24oKVxuICAgIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSlcbiAgY29uc29sZS5sb2cocmVzKVxufVxuXG5cbmV4cG9ydCBjb25zdCB1cGRhdGVQcm9qZWN0VGVjaG5vbG9naWVzID0gYXN5bmMgKHByb2plY3RfaWQsIGlkKSA9PiB7XG4gIGNvbnNvbGUubG9nKCd1cHQnKVxuICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9wcm9qZWN0cy8ke3Byb2plY3RfaWR9L3RlY2hub2xvZ2llcy8ke2lkfWAsIHtcbiAgICBtZXRob2Q6IGBwdXRgLFxuICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XG4gIH0pXG4gICAgLnRoZW4oKGpzb24pID0+IHtcbiAgICAgIHJldHVybiBqc29uLmpzb24oKVxuICAgIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSlcbiAgY29uc29sZS5sb2cocmVzKVxuXG59Il0sInNvdXJjZVJvb3QiOiIifQ==